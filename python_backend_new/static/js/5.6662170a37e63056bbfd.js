webpackJsonp([5],{RAIY:function(e,t,o){"use strict";var i=o("aA9S"),a=o.n(i),n=o("SdNV"),s={props:{list:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},operates:{type:Object,default:function(){}},pagination:{type:Object,default:{}},getList:Function,options:{type:Object,default:{}},tempCb:{type:Array,default:function(){return[]}},oldRow:{type:Array,default:function(){return[]}}},components:{expandDom:{functional:!0,props:{row:Object,render:Function,index:Number,column:{type:Object,default:null}},render:function(e,t){var o={row:t.props.row,index:t.props.index};return t.props.column&&(o.column=t.props.column),t.props.render(e,o)}}},data:function(){return{multipleSelection:[],radio:"",selected:{}}},created:function(){!1!==this.options.initTable&&this.getList(),this.$parent.options=a()({maxHeight:500,initTable:!0,stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!1,border:!0},this.options)},mounted:function(){this.radio="",this.selected={}},methods:{handleSizeChange:function(e){this.pagination.pageSize=e,this.$emit("handleSizeChange",this.pagination)},handleIndexChange:function(e){this.pagination.pageIndex=e,this.$emit("handleIndexChange",this.pagination),this.radio="",this.$emit("handleRowClick","",this.radio)},handleSelectionChange:function(e){this.multipleSelection=e,this.$emit("handleSelectionChange",this.multipleSelection)},handleRowClick:function(e,t,o){this.radio=this.list.indexOf(e),this.selected=e,this.$emit("handleRowClick",e,this.radio)},handleSelect:function(e,t){}},watch:{list:function(e){console.info("list : "+e),console.info(this.oldRow),this.radio=""},tempCb:function(e,t){var o=this;console.info("tempCb--\x3e1"),console.info(t),console.info(e),e.length>=t.length?console.info("tempCb添加时不监控"):(console.info("tempCb删除时监控"),this.options.canPostEvent=!1,this.$refs.mutipleTable.clearSelection(),e.forEach(function(e){o.$refs.mutipleTable.toggleRowSelection(e,!0)}),this.$nextTick(function(){this.options.canPostEvent=!0})),console.info("tempCb--\x3e2")}}},r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"op-table"},[o("div",{staticClass:"table-wrap"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.options.loading,expression:"options.loading"}],ref:"mutipleTable",attrs:{data:e.list,"max-height":e.options.maxHeight,stripe:e.options.stripe,"highlight-current-row":"","header-cell-class-name":"table-header",border:e.options.border},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick,select:e.handleSelect}},[e.options.mutiSelect?o("el-table-column",{staticStyle:{width:"50px"},attrs:{type:"selection"}}):e._e(),e._v(" "),e.options.singleSelect?o("el-table-column",{attrs:{label:"选择",width:"50",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-radio",{attrs:{label:t.$index},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" ")])]}}],null,!1,561508731)}):e._e(),e._v(" "),e.options.index?o("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}):e._e(),e._v(" "),e._l(e.columns,function(t,i){return[o("el-table-column",{key:i,attrs:{prop:t.prop,label:t.label,align:t.align||"center",width:t.width,fixed:t.fixed,sortable:t.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[t.render?[o("expand-dom",{attrs:{column:t,row:a.row,render:t.render,index:i}})]:[t.formatter?[o("span",{domProps:{innerHTML:e._s(t.formatter(a.row,t))}})]:[o("span",[e._v(e._s(a.row[t.prop]))])]]]}}],null,!0)})]}),e._v(" "),e.operates?o("el-table-column",{ref:"fixedColumn",attrs:{label:"操作",align:"center",width:e.operates.width,fixed:e.operates.fixed},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"operate-group"},[e._l(e.operates.list,function(i,a){return[("function"==typeof i.show?i.show(t.$index,t.row):i.show)?o("el-button",{attrs:{type:i.type,size:"mini",icon:i.icon,disabled:i.disabled,plain:i.plain},nativeOn:{click:function(e){return e.preventDefault(),i.method(t.row,t.$index,a)}}},[e._v(e._s(i.label))]):e._e()]})],2)]}}],null,!1,3124777626)}):e._e()],2)],1),e._v(" "),e.pagination.show?o("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"right"},attrs:{"page-size":e.pagination.pageSize,"page-sizes":e.pagination.pageSizeArr&&e.pagination.pageSizeArr.length>0?e.pagination.pageSizeArr:[10,50,100,500,5e3],"current-page":e.pagination.pageIndex,layout:"total,sizes, prev, pager, next,jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleIndexChange}}):e._e()],1)},staticRenderFns:[]};var l=o("C7Lr")(s,r,!1,function(e){o("qOHN")},"data-v-e1ffc592",null).exports,m=o("M/4X"),p=o("kiIx"),c=o("/b2t"),f={props:{rules:{type:Object,default:function(){}},formData:{type:Object,default:function(){}},formOptions:{type:Object,default:function(){}},formLoading:Boolean,formItems:{type:Array,default:function(){return[]}},formBtnList:{type:Array,default:function(){return[]}},handleType:String,handleCancleBtn:String},data:function(){return{defaultOptions:{labelPosition:"left",labelWidth:"80px",size:"medium",disabled:!1,hideRequiredAsterisk:!1},currentIndex:-1}},components:{FileItem:m.a,deptGroup:n.a,opTable:l,uploadAttach:p.a,Editor:c.a},methods:{Sumbit:function(e,t,o){this.$emit("successUpload",e,t,o)},initClick:function(e){this.currentIndex=e,console.info("this.currentIndex = "+this.currentIndex),this.handleSearch()},editData:function(e){},handleCofirm:function(){this.$refs.deptCarser&&this.$refs.deptCarser[0].getSelected(),this.$emit("handleCofirm",this.formData)},handleCancle:function(){this.$refs.formData.resetFields(),this.$refs.deptCarser&&this.$refs.deptCarser[0].resetSelect(),this.$emit("handleCancle")},initSelect:function(){this.$refs.deptCarser[0].init()},handleClick:function(e){this.$refs.deptCarser&&this.$refs.deptCarser[0].getSelected(),"function"==typeof this[e]?this[e]():this.$emit(e)},resetForm:function(e){console.log(this.$refs.formData),e?this.$refs.formData.resetFields(e):this.$refs.formData.resetFields()},clearValidateForm:function(){this.$refs.formData.clearValidate()},validateForm:function(){var e=this,t=!1;return this.$refs.formData.validate(function(o,i){o?t=!0:(e.$message({type:"error",message:"表单验证失败"}),t=!1)}),t},validateField:function(e){this.$refs.formData.validateField(e)},resetDeptCarser:function(){this.$refs.deptCarser[0].resetSelect()},validateFormField:function(e){this.$refs.formData.validateField(e)},handleList:function(e){var t=this.currentIndex;(0,this.formItems[t].handleList)(t,e)},handleSizeChange:function(e){var t=this.currentIndex;this.formItems[t].pagination=e,console.log("handleSizeChange:"+this.formItems[t].pagination.pageSize),this.handleList(this.formItems[t].pagination)},handleIndexChange:function(e){var t=this.currentIndex;this.formItems[t].pagination=e,console.log("handleIndexChange:"+this.formItems[t].pagination.pageIndex),console.log("handleIndexChange:"+this.formItems[t].pagination.pageSize),this.handleList(this.formItems[t].pagination)},handleSelectionChange:function(e){console.log("当前页面选中的所有行val:",e);var t=this.currentIndex;if(this.formItems[t].selectRow=e,this.formItems[t].options.mutiSelect)if(this.formItems[t].list&&this.formItems[t].list.length>0){var o=this.formItems[t].handleSelectionChange;console.info("canPostEvent = "+this.formItems[t].options.canPostEvent),this.formItems[t].options.canPostEvent&&o(t,e)}else console.log("当前页面已经没有数据了，不再回调")},handleRowClick:function(e,t,o){var i=this.currentIndex;console.info("handleRowClick-----------------\x3e"),e&&(console.info("row = "+e),console.info("itemIndex="+i),this.formItems[i].options.singleSelect&&(this.formItems[i].selectRow=e))},handleRowOkClick:function(e){var t=this.currentIndex,o=this.formItems[t].method,i=void 0;i=this.formItems[t].options.singleSelect?this.formItems[t].selectRow:this.formItems[t].tempKV,console.info("handleRowOkClick-----------------\x3eOK"),console.info(i),console.info("itemIndex="+t),""==i||i.length<=0?this.$message({type:"warning",message:"请选择一行数据"}):(o(i,t),this.$refs.formData.validateField(this.formItems[t].prop))},handleRowCancelClick:function(){var e=this.currentIndex;this.formItems[e].selectRow="",this.formItems[e].searchText="",this.formItems[e].total=0,this.formItems[e].list=[],this.formItems[e].pagination.pageIndex=1,this.formItems[e].pagination.total=0,this.formItems[e].visible=!1},handleSearch:function(){var e=this.currentIndex,t=this.formItems[e].handleSearch;t(e)},itemChange:function(e){alert(e)}},created:function(){this.$parent.$parent.formOptions?this.$parent.$parent.formOptions=a()({labelPosition:"right",labelWidth:"80px",size:"medium",disabled:!1,hideRequiredAsterisk:!1},this.formOptions):this.$parent.formOptions=a()({labelPosition:"right",labelWidth:"80px",size:"medium",disabled:!1,hideRequiredAsterisk:!1},this.formOptions)},computed:{getOptionLabels:{get:function(){var e=[],t=this.currentIndex;if(console.info("get----getOptionLabels...itemIndex = "+t),t>-1&&this.formItems[t].options.mutiSelect){var o=this.formItems[t].tempKV;console.info(o);for(var i=0;i<o.length;i++){var a=o[i].serial+"."+o[i].label;e.push(a)}}return e},set:function(e){var t=this.currentIndex;console.info("set----getOptionLabels...itemIndex = "+t),console.info(e),console.info("更新 tempKV");for(var o=this.formItems[t].tempKV,i=this.formItems[t].oldRow,a=0;a<o.length;a++){for(var n=-1,s=0;s<e.length;s++){if(o[a].serial+"."+o[a].label==e[s]){n=s;break}}if(-1==n){o.splice(a,1),i.splice(a,1);break}}console.info(o),this.formItems[t].tempKV=o,this.formItems[t].oldRow=i}},dataModel:function(){for(var e in this.formData)this.$set(this.formData,e,this.formData[e]);return this.formData}},watch:{getOptionLabels:function(e,t){console.info("watch--getOptionLabels--\x3estart"),console.info(t),console.info(e);var o=this.currentIndex;this.formItems[o].options.mutiSelect&&(0,this.formItems[o].changeCb)(o,e);console.info("watch--getOptionLabels--\x3eend")}}},h={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"form-model"},[o("el-form",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"formData",attrs:{model:e.formData,rules:e.rules}},"el-form",e.formOptions,!1),e._l(e.formItems,function(t,i){return void 0==t.show||t.show?o("el-form-item",{key:t.prop,attrs:{prop:t.prop,rules:t.rules,label:t.label}},["selectgroup"==t.type?o("deptGroup",{ref:"deptCarser",refInFor:!0,model:{value:e.formData[t.prop],callback:function(o){e.$set(e.formData,t.prop,o)},expression:"formData[item.prop]"}}):"editor"==t.type?o("Editor",{ref:"editorPage",refInFor:!0,attrs:{imageShow:t.imageShow,operation:"File_Result_Owner_Ent_Path",defaultValue:t.defaultValue,apiUrl:t.apiUrl},on:{editData:e.editData},model:{value:e.dataModel[t.prop],callback:function(o){e.$set(e.dataModel,t.prop,o)},expression:"dataModel[item.prop]"}}):"upload"==t.type?o("uploadAttach",{ref:"uploadfile",refInFor:!0,attrs:{flag:t.state,icon:t.icon,limitNum:t.limitNum,uploadTips:t.uploadTxt||"",uploadBtnTxt:t.uploadBtnTxt||"",listType:t.listType,acceptType:t.acceptType,defaultList:t.defaultList},on:{validateFormField:e.validateFormField},model:{value:e.dataModel[t.prop],callback:function(o){e.$set(e.dataModel,t.prop,o)},expression:"dataModel[item.prop]"}}):"popover"==t.type?o("el-popover",{attrs:{placement:"right","visible-arrow":"false",width:"600",trigger:"click"},model:{value:t.visible,callback:function(o){e.$set(t,"visible",o)},expression:"item.visible"}},[[o("div",{staticStyle:{"margin-top":"15px","margin-bottom":"15px"}},[o("el-input",{staticClass:"input-with-select",staticStyle:{width:"460px"},attrs:{placeholder:"请输入搜索内容"},model:{value:t.searchText,callback:function(o){e.$set(t,"searchText",o)},expression:"item.searchText"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:e.handleRowCancelClick}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{size:"small",type:"success"},on:{click:e.handleRowOkClick}},[e._v("确定")]),e._v(" "),o("div",[t.options.mutiSelect&&t.visible?o("el-select",{staticStyle:{width:"100%","margin-top":"5px"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"已经选中的信息"},model:{value:e.getOptionLabels,callback:function(t){e.getOptionLabels=t},expression:"getOptionLabels"}}):e._e()],1)],1),e._v(" "),o("opTable",{attrs:{list:t.list,total:t.total,options:t.options,pagination:t.pagination,columns:t.columns,operates:t.operates,getList:e.handleList,tempCb:t.tempCb,oldRow:t.oldRow},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange,handleRowClick:e.handleRowClick}}),e._v(" "),[o("div",{staticStyle:{float:"right","margin-top":"15px"}})]],e._v(" "),o("el-input",e._b({attrs:{slot:"reference","suffix-icon":"el-icon-edit","trigger-on-focus":!1},on:{focus:function(t){return e.initClick(i)}},slot:"reference",model:{value:t.options.mutiSelect?t.defaultLabel.toString():t.defaultLabel,callback:function(o){e.$set(t.options.mutiSelect?t.defaultLabel.toString():t,"defaultLabel",o)},expression:"item.options.mutiSelect?item.defaultLabel.toString():item.defaultLabel"}},"el-input",t.eleProps||{},!1))],2):o("el-"+t.type,e._b({directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"item.loading"}],tag:"component",style:t.style?t.style:"",attrs:{"trigger-on-focus":!1},on:{change:function(e){t.change&&t.change(e)}},model:{value:e.formData[t.prop],callback:function(o){e.$set(e.formData,t.prop,o)},expression:"formData[item.prop]"}},"component",t.eleProps||{},!1),[e._l(t.options,function(i){return"select"==t.type&&t.group?o("el-option-group",{key:i.label,attrs:{label:i.label}},e._l(i.options,function(i){return"select"==t.type?o("el-option",{key:i.value,attrs:{label:i.label,value:i.value}}):e._e()}),1):e._e()}),e._v(" "),e._l(t.options,function(i){return"select"!=t.type||t.group?e._e():o("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),e._v(" "),e._l(t.options,function(i){return"radio-group"==t.type?o("el-radio",{key:i.value,attrs:{label:i.label}},[e._v("\n                    "+e._s(i.value)+"\n                ")]):e._e()}),e._v(" "),e._l(t.options,function(i){return"checkbox-group"==t.type?o("el-checkbox",{key:i.value,attrs:{label:i.label}},[e._v(e._s(i.value)+"\n                ")]):e._e()})],2)],1):e._e()}),1),e._v(" "),o("div",{staticClass:"dialog-footer text-right"},[e.formBtnList.length&&e.formBtnList.length>0?e._l(e.formBtnList,function(t,i){return o("el-button",{key:i,attrs:{type:t.type,size:t.size||"small",icon:t.icon,disabled:t.disabled,plain:t.plain},on:{click:function(o){return e.handleClick(t.method)}}},[e._v(e._s(t.label)+"\n            ")])}):[o("el-button",{on:{click:e.handleCancle}},[e._v(e._s(e.handleCancleBtn?e.handleCancleBtn:"取消"))]),e._v(" "),o("el-button",{attrs:{type:"success"},on:{click:e.handleCofirm}},[e._v(e._s("new"==e.handleType?"添 加":"edit"==e.handleType?"修改":e.handleType)+"\n            ")])]],2)],1)},staticRenderFns:[]};var d=o("C7Lr")(f,h,!1,function(e){o("pt5p")},"data-v-f2f35116",null);t.a=d.exports},a1UP:function(e,t){},bypY:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("a3Yh"),a=o.n(i),n=o("ZLEe"),s=o.n(n),r=o("D4TX"),l=o("YaB9"),m={data:function(){return{search_word:"",select:"",value1:"",value2:"",setps:l.s}},props:{handleConfig:Object},methods:{delAll:function(){this.$emit("delAll")},auditAll:function(){this.$emit("auditAll")},newItem:function(){this.$emit("newItem")},search:function(){var e=this.value1,t=this.value2,o="";-1==e&&(o=1,e="",t=""),this.$emit("search",this.select,this.search_word,e,t,o)},handleItemChange:function(e){console.log(e)},stepchange:function(e){this.value2=""}},computed:{childoptions:function(){var e=this.value1,t=[];if(t.push({label:"所有子步骤",value:""}),e)for(var o=0;o<this.setps.length;o++){var i=this.setps[o];if(console.info(i),console.info(i.value+",,"+e),i.value==e){i.children.forEach(function(e){t.push(e)});break}}return t}}},p={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"search-bar"},[o("div",{staticClass:"handle-box"},[o("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入项目名称"},model:{value:e.search_word,callback:function(t){e.search_word=t},expression:"search_word"}}),e._v(" "),o("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"所有主步骤"},on:{change:e.stepchange},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.setps,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),o("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"所有子步骤"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.childoptions,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),o("el-button",{attrs:{slot:"append",icon:"el-icon-search",type:"primary"},on:{click:e.search},slot:"append"},[e._v("搜索")]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:void 0!=e.handleConfig.newItemTxt?e.handleConfig.newItemTxt:1,expression:"handleConfig.newItemTxt != undefined ? handleConfig.newItemTxt : 1"}],attrs:{type:"primary"},on:{click:e.newItem}},[e._v(e._s(e.handleConfig.newItemTxt))]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:void 0!=e.handleConfig.delBtn?e.handleConfig.delBtn:1,expression:"handleConfig.delBtn != undefined ? handleConfig.delBtn : 1"}],staticClass:"handle-del mr10",attrs:{type:"danger",icon:"delete"},on:{click:e.delAll}},[e._v("批量删除")]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:void 0!=e.handleConfig.auditBtn?e.handleConfig.auditBtn:0,expression:"handleConfig.auditBtn != undefined ?  handleConfig.auditBtn : 0"}],staticClass:"handle-audit mr10",attrs:{type:"info",icon:"edit"},on:{click:e.auditAll}},[e._v("批量审核")])],1)])},staticRenderFns:[]};var c=o("C7Lr")(m,p,!1,function(e){o("a1UP")},"data-v-d87afac0",null).exports,f=o("R5Jg"),h={data:function(){var e=this;return{project_from_str:l.q,project_cstate_str:l.p,project_from_str_json:l.r,dialogTitle:"",dialogFormVisible:!1,serial:"",rules:{project_name:[{required:!0,message:"请输入项目名称",trigger:"blur"}],project_from:[{required:!0,message:"请选择项目来源",trigger:"blur"}],project_major:[{required:!0,message:"请选择项目领域",trigger:"blur"}],brokers:[{required:!0,message:"请输入项目经纪人",trigger:"blur"}],requirements:[{required:!0,message:"请输入项目主需求",trigger:"blur"}],results:[{required:!0,message:"请输入项目主成果",trigger:"blur"}],experts:[{required:!0,message:"请输入项目专家",trigger:"blur"}],project_desc:[{required:!0,message:"请输入项目简介",trigger:"blur"}]},currentEditLine:0,select_word:"",project_state:"",project_sub_state:"",isend:"",formData:{},handleType:"new",formOptions:{labelWidth:"120px"},formLoading:!1,formItems:[{prop:"project_name",text:"项目名称",label:"项目名称",type:"input",eleProps:{placeholder:"请输入项目名称",readonly:!1}},{prop:"project_from",label:"项目来源",type:"select",eleProps:{placeholder:"请选择项目来源"},show:!0,options:l.r,change:function(t){e.$refs.formData.validateField("project_from")}},{prop:"project_major",label:"项目领域",type:"select",eleProps:{placeholder:"请选择项目领域",multiple:!0},show:!0,options:[],group:!0,style:{width:"100%",height:"40px"},loading:!1,change:function(t){e.$refs.formData.validateField("project_major")}},{prop:"brokers",text:"项目技术经理人",label:"技术经理人",type:"popover",eleProps:{placeholder:"请选择项目技术经理人",readonly:!0},defaultValue:"",defaultLabel:"",selectRow:"",searchText:"",visible:!1,pagination:{pageIndex:1,pageSize:5,pageSizeArr:[5,10,50,100,500,5e3],show:!0,total:0},options:{index:!0,stripe:!0,loading:!1,highlightCurrentRow:!0,singleSelect:!0,mutiSelect:!1,initTable:!1},total:0,list:[],columns:[{prop:"broker_name",label:"姓名",align:"center",width:250},{prop:"broker_mobile",label:"电话",align:"center",width:250}],method:function(t,o){console.info("method------------------\x3e"),console.info(t),console.info(o),e.formItems[o].defaultValue=t.broker_code,e.formItems[o].defaultLabel=t.broker_name,e.$set(e.formData,e.formItems[o].prop,t.broker_code),e.formItems[o].visible=!1,console.info(e.formData),e.formItems[o].selectRow="",e.formItems[o].searchText="",e.formItems[o].total=0,e.formItems[o].list=[],e.formItems[o].pagination.pageIndex=1,e.formItems[o].pagination.total=0},handleSearch:function(t){e.formItems[t].total=0,e.formItems[t].list=[],e.formItems[t].pagination.pageIndex=1,e.formItems[t].pagination.total=0,e.handleList(t)},handleList:function(t,o){console.info("handleList.pagination",o),e.formItems[t].pagination.pageIndex=o.pageIndex,e.formItems[t].pagination.pageSize=o.pageSize,e.handleList(t)}},{prop:"requirements",text:"项目主需求",label:"项目主需求",type:"popover",eleProps:{placeholder:"请选择项目主需求",readonly:!0},defaultValue:"",defaultLabel:"",selectRow:"",searchText:"",visible:!1,pagination:{pageIndex:1,pageSize:5,pageSizeArr:[5,10,50,100,500,5e3],show:!0,total:0},options:{index:!0,stripe:!0,loading:!1,highlightCurrentRow:!0,singleSelect:!0,mutiSelect:!1,initTable:!1},total:0,list:[],columns:[{prop:"req_name",label:"需求名称",align:"center",width:300},{prop:"use_type",label:"使用方式",align:"center",width:100},{prop:"osource_name",label:"来源",align:"center",width:100}],method:function(t,o){console.info("method------------------\x3e"),console.info(t),console.info(o),e.formItems[o].defaultValue=t.req_code,e.formItems[o].defaultLabel=t.req_name,e.$set(e.formData,e.formItems[o].prop,t.req_code),e.formItems[o].visible=!1,console.info(e.formData),e.formItems[o].selectRow="",e.formItems[o].searchText="",e.formItems[o].total=0,e.formItems[o].list=[],e.formItems[o].pagination.pageIndex=1,e.formItems[o].pagination.total=0},handleSearch:function(t){e.formItems[t].total=0,e.formItems[t].list=[],e.formItems[t].pagination.pageIndex=1,e.formItems[t].pagination.total=0,e.handleList(t)},handleList:function(t,o){console.info("handleList.pagination",o),e.formItems[t].pagination.pageIndex=o.pageIndex,e.formItems[t].pagination.pageSize=o.pageSize,e.handleList(t)}},{prop:"results",text:"项目主成果",label:"项目主成果",type:"popover",eleProps:{placeholder:"请选择项目主成果",readonly:!0},defaultValue:"",defaultLabel:"",selectRow:"",searchText:"",visible:!1,pagination:{pageIndex:1,pageSize:5,pageSizeArr:[5,10,50,100,500,5e3],show:!0,total:0},options:{index:!0,stripe:!0,loading:!1,highlightCurrentRow:!0,singleSelect:!0,mutiSelect:!1,initTable:!1},total:0,list:[],columns:[{prop:"r_name",label:"成果名称",align:"center",width:300},{prop:"use_type",label:"使用方式",align:"center",width:100},{prop:"osource_name",label:"来源",align:"center",width:100}],method:function(t,o){console.info("method------------------\x3e"),console.info(t),console.info(o),e.formItems[o].defaultValue=t.r_code,e.formItems[o].defaultLabel=t.r_name,e.$set(e.formData,e.formItems[o].prop,t.r_code),e.formItems[o].visible=!1,console.info(e.formData),e.formItems[o].selectRow="",e.formItems[o].searchText="",e.formItems[o].total=0,e.formItems[o].list=[],e.formItems[o].pagination.pageIndex=1,e.formItems[o].pagination.total=0},handleSearch:function(t){e.formItems[t].total=0,e.formItems[t].list=[],e.formItems[t].pagination.pageIndex=1,e.formItems[t].pagination.total=0,e.handleList(t)},handleList:function(t,o){console.info("handleList.pagination",o),e.formItems[t].pagination.pageIndex=o.pageIndex,e.formItems[t].pagination.pageSize=o.pageSize,e.handleList(t)}},{prop:"experts",text:"项目专家",label:"项目专家",type:"popover",eleProps:{placeholder:"请选择项目专家",readonly:!0},defaultValue:"",defaultLabel:"",oldRow:[],tempKV:[],tempCb:[],selectRow:"",searchText:"",visible:!1,pagination:{pageIndex:1,pageSize:5,pageSizeArr:[5,10,50,100,500,5e3],show:!0,total:0},options:{index:!1,stripe:!0,loading:!1,highlightCurrentRow:!0,singleSelect:!1,mutiSelect:!0,initTable:!1,canPostEvent:!0},total:0,list:[],columns:[{prop:"expert_name",label:"专家名称",align:"center",width:300},{prop:"expert_mobile",label:"专家手机",align:"center",width:250}],method:function(t,o){if(console.info("method------------------\x3e"),console.info(t),console.info(o),console.info(e.formItems[o].options.singleSelect),e.formItems[o].options.singleSelect)e.formItems[o].defaultValue=t.expert_code,e.formItems[o].defaultLabel=t.expert_name,e.$set(e.formData,e.formItems[o].prop,t.expert_code),e.formItems[o].visible=!1,console.info(e.formData);else{for(var i=[],a=[],n=e.formItems[o].tempKV,s=0;s<n.length;s++){var r=n[s];i.push(r.value),a.push(r.label)}e.formItems[o].defaultValue=i,e.formItems[o].defaultLabel=a,e.$set(e.formData,e.formItems[o].prop,i),e.formItems[o].visible=!1,console.info(e.formData)}e.formItems[o].selectRow="",e.formItems[o].searchText="",e.formItems[o].total=0,e.formItems[o].list=[],e.formItems[o].pagination.pageIndex=1,e.formItems[o].pagination.total=0},handleSearch:function(t){e.formItems[t].total=0,e.formItems[t].list=[],e.formItems[t].pagination.pageIndex=1,e.formItems[t].pagination.total=0,e.handleList(t)},handleList:function(t,o){console.info("handleList.pagination",o),e.formItems[t].pagination.pageIndex=o.pageIndex,e.formItems[t].pagination.pageSize=o.pageSize,e.handleList(t)},handleSelectionChange:function(t,o){console.info("handleSelectionChange----\x3e当前页"),console.info(t),console.info(o);for(var i=e.formItems[t].tempKV,a=e.formItems[t].oldRow,n=e.formItems[t].list,s=0;s<n.length;s++){for(var r=-1,l=0;l<o.length;l++)if(n[s].expert_code==o[l].expert_code){r=l;break}if(-1==r)for(var m=i.length,p=0;p<m;p++)if(i[p].value==n[s].expert_code){i.splice(p,1),a.splice(p,1);break}}for(var c=0;c<o.length;c++){for(var f=-1,h=0;h<i.length;h++)if(i[h].value==o[c].expert_code){f=h;break}-1==f&&(i.push({serial:o[c].serial,label:o[c].expert_name,value:o[c].expert_code}),a.push(o[c]))}console.info("handleSelectionChange-tempKV>"+i),console.info("handleSelectionChange-oldRow>"+a),e.formItems[t].tempKV=i,e.formItems[t].oldRow=a},changeCb:function(t,o){console.info("changeCb----\x3e"),console.info(t),console.info(o);for(var i=e.formItems[t].list,a=[],n=0;n<i.length;n++)for(var s=0;s<o.length;s++){i[n].serial+"."+i[n].expert_name==o[s]&&a.push(i[n])}e.formItems[t].tempCb=a}},{prop:"project_desc",text:"项目简介",label:"项目简介",type:"input",eleProps:{type:"textarea",placeholder:"请输入项目简介",rows:4}},{prop:"Attach",label:"附件",type:"upload",state:"attachment",defaultList:[],limitNum:9,show:!0,$default:null,listType:"text",icon:o("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.PDF,.DOC,.DOCX,.XLS,.XLSX,.zip,.rar,RAR,.jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"附件"}},{prop:"Cover",label:"封面",type:"upload",defaultList:[],$default:null,state:"Cover",show:!0,listType:"picture",icon:o("6pu8"),acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"封面"}}],handleConfig:{searchTerms:[{value:"project_name",label:"项目名称"}],newItemTxt:"新增项目",delBtn:!1},total:0,list:[],columns:[{prop:"project_name",label:"项目名称",align:"center",width:250},{prop:"project_state",label:"项目阶段",align:"center",width:"80",render:function(e,t){return e("span",{},Object(l.h)(t.row.project_state))}},{prop:"project_sub_state",label:"项目子阶段",align:"center",width:"120",render:function(e,t){return e("span",{},Object(l.j)(t.row.project_state,t.row.project_sub_state))}},{prop:"substep_serial_type",label:"子步骤操作类型",align:"center",width:"120",formatter:function(e,t,o){var i=0;return"undefined"!=e.substep_serial_info&&e.substep_serial_info.length>0&&(i=e.substep_serial_info[0].substep_serial_type),Object(l.k)(e.project_state,e.project_sub_state,i)}},{prop:"substep_state",label:"项目当前阶段状态",align:"center",width:"130",render:function(e,t){var o=Object(l.l)(t.row.project_state,t.row.project_sub_state,t.row.substep_info.substep_state),i="";return"草稿箱"==o?i="info":"提交待审核"==o?i="":"审核通过"==o?i="success":"审核未通过"==o?i="danger":"放弃项目待审核"==o?i="":"放弃项目"==o?i="warning":"放弃项目不通过"==o?i="danger":"正在进行中"==o?i="":"成功完成"==o&&(i="success"),e("el-tag",{props:{type:i}},o)}},{prop:"broker_name",label:"技术经理人",align:"center",width:100,render:function(e,t){return e("span",{},t.row.broker_info.broker.broker_name)}},{prop:"project_from",label:"项目来源",align:"center",width:200,render:function(t,o){return t("span",{props:{}},void 0===e.project_from_str[o.row.project_from]?"不详":e.project_from_str[o.row.project_from])}},{prop:"project_start_time",label:"项目立项时间",align:"center",width:160},{prop:"last_time",label:"项目截止时间",align:"center",width:160},{prop:"insert_time",label:"项目创建时间",align:"center",width:160}],operates:{width:280,fixed:"right",list:[{label:"编辑",type:"warning",show:function(e,t){return!0},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,o){e.handleEdit(t,o)}},{label:"删除",type:"danger",icon:"el-icon-delete",show:!0,plain:!1,disabled:!1,method:function(t,o){e.handleDel(t,o)}},{label:"详情",type:"primary",show:function(e,t){return!0},icon:"el-icon-info",plain:!0,disabled:!1,method:function(t,o){e.handleDetail(t,o)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{index:!0,stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!1}}},components:{jsonForm:o("RAIY").a,curmbs:r.a,handleBox:c,opTable:f.a},methods:{handleClose:function(e){this.$refs.formDialog.$children[0].$refs.formData.clearValidate(),e()},handleCofirm:function(e){var t=this;if(console.info("handleCofirm-----------\x3e"),console.log(e),!this.$refs.formData.validateForm())return!1;"new"==this.handleType&&(null!=e.Attach&&e.Attach.length>0&&e.Attach[0].response&&(e.Attach=this.Attch(e.Attach)),null!=e.Cover&&(e.Cover=this.Cover(e)),Object(l.a)(e).then(function(e){e.detail?t.$message.error(e.detail):(console.log(e),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加成功!"}),t.getList())})),"edit"==this.handleType&&(null!=e.Attach&&e.Attach.length>0&&e.Attach[0].response&&(e.Attach=this.Attch(e.Attach)),null!=e.Cover&&(e.Cover=this.Cover(e)),this.formLoading=!0,Object(l.c)(this.serial,e).then(function(e){e.detail?t.$message.error(e.detail):(t.list.splice(t.currentEditLine,1,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"编辑成功!"}),t.formLoading=!1)}))},Attch:function(e){for(var t=[],o=[],i=0;i<e.length;i++)o=s()(e[i].response),t.push(e[i].response[o][0]);return t},Cover:function(e){for(var t={},o=0;o<this.formItems.length;o++)if("upload"==this.formItems[o].type){var i=this.formItems[o].prop;if("Attach"!=i){var a=null;a=e[i]?e[i]:null,t[i="Cover"==i?"coverImg":"PerIdBack"==i?"identityBack":"PerHandId"==i?"handIdentityPhoto":"PerIdFront"==i?"identityFront":"EntLicense"==i?"entLicense":"agreement"]=a}}return t},newItem:function(){for(var e=this,t=0;t<this.formItems.length;t++){if("switch"==this.formItems[t].type?this.$set(this.formData,this.formItems[t].prop,0):this.$set(this.formData,this.formItems[t].prop,""),"brokers"==this.formItems[t].prop||"requirements"==this.formItems[t].prop||"results"==this.formItems[t].prop||"experts"==this.formItems[t].prop){this.formItems[t].defaultLabel="",this.formItems[t].defaultValue="",this.formItems[t].total=0,this.formItems[t].list=[],this.formItems[t].pagination.pageIndex=1,this.formItems[t].pagination.total=0,this.formItems[t].selectRow="",this.formItems[t].selectText="",this.formItems[t].options.mutiSelect&&(this.formItems[t].oldRow=[],this.formItems[t].tempKV=[],this.formItems[t].tempCb=[]),this.$set(this.formData,this.formItems[t].prop,"")}"project_major"==this.formItems[t].prop&&this.$set(this.formData,this.formItems[t].prop,[]),"Attach"==this.formItems[t].prop&&(this.formItems[t].show=!0,this.formItems[t].defaultList=[]),"Cover"==this.formItems[t].prop&&(this.formItems[t].show=!0,this.formItems[t].defaultList=[])}this.initMajors(),this.dialogTitle="新增项目",this.currentEditLine=0,this.handleType="new",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.formDialog.$children[0].$refs.formData.clearValidate()})},search:function(e,t,o,i,a){console.log("search:"+e+","+t+","+o+","+i+","+a),this.select_word=t,this.project_state=o,this.project_sub_state=i,this.isend=a,this.getList()},delAll:function(){},getList:function(){var e=this;this.options.loading=!0,Object(l.m)({params:{page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word,project_state:this.project_state,project_sub_state:this.project_sub_state,isend:this.isend}}).then(function(t){e.total=t.data.count,e.pagination.total=Number(t.data.count),e.list=t.data.results,e.options.loading=!1})},handleSizeChange:function(e){this.pagination=e,console.log("handleSizeChange:"+this.pagination.pageSize),this.getList()},handleIndexChange:function(e){this.pagination=e,console.log("handleIndexChange:"+this.pagination.pageIndex),this.getList()},handleSelectionChange:function(e){console.log("val:",e)},handleEdit:function(e,t){var o=this;console.info(e),this.currentEditLine=t,this.dialogTitle="编辑项目信息",this.handleType="edit",this.serial=e.pserial,this.getInitList(e,t),this.dialogFormVisible=!0,this.$nextTick(function(){o.$refs.formDialog.$children[0].$refs.formData.clearValidate()})},handleDel:function(e,t){var o=this;console.info(e),this.$confirm("此操作将永久删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.b)(e.pserial).then(function(e){e.detail?o.$message.error(e.detail):o.list.splice(t,1)}).then(function(){o.$message({type:"success",message:"删除成功!"})})}).catch(function(){})},handleDetail:function(e,t){this.$router.push({name:"project_detail",query:{serial:e.pserial}})},getInitList:function(e,t){this.formLoading=!0,console.info("getInitList...");for(var o=0;o<this.formItems.length;o++){if(void 0!==e[this.formItems[o].prop]&&(e[this.formItems[o].prop]?this.$set(this.formData,this.formItems[o].prop,e[this.formItems[o].prop]):this.$set(this.formData,this.formItems[o].prop,"")),"brokers"==this.formItems[o].prop){var i=e.broker_info.broker.broker_code,a=e.broker_info.broker.broker_name;this.formItems[o].defaultLabel=a,this.formItems[o].defaultValue=i,this.formItems[o].total=0,this.formItems[o].list=[],this.formItems[o].pagination.pageIndex=1,this.formItems[o].pagination.total=0,this.$set(this.formData,this.formItems[o].prop,i)}if("requirements"==this.formItems[o].prop){for(var n="",s="",r=e.rr,l=0;l<r.length;l++){var m=r[l];2==m.rr_type&&1==m.rr_main&&(n=m.rr_code,s=m.requirements_info.req_name)}this.formItems[o].defaultLabel=s,this.formItems[o].defaultValue=n,this.formItems[o].total=0,this.formItems[o].list=[],this.formItems[o].pagination.pageIndex=1,this.formItems[o].pagination.total=0,this.$set(this.formData,this.formItems[o].prop,n)}if("results"==this.formItems[o].prop){for(var p="",c="",f=e.rr,h=0;h<f.length;h++){var d=f[h];1==d.rr_type&&1==d.rr_main&&(p=d.rr_code,c=d.results_info.r_name)}this.formItems[o].defaultLabel=c,this.formItems[o].defaultValue=p,this.formItems[o].total=0,this.formItems[o].list=[],this.formItems[o].pagination.pageIndex=1,this.formItems[o].pagination.total=0,this.$set(this.formData,this.formItems[o].prop,p)}if("experts"==this.formItems[o].prop){for(var u=[],g=[],I=[],b=[],v=e.expert_info,_=0;_<v.length;_++){var x=v[_];u.push(x.expert_code),g.push(x.expert.expert_name),b.push(x.expert),I.push({serial:x.expert.serial,label:x.expert.expert_name,value:x.expert_code})}this.formItems[o].defaultLabel=g,this.formItems[o].defaultValue=u,this.formItems[o].tempKV=I,this.formItems[o].oldRow=b,this.formItems[o].total=0,this.formItems[o].list=[],this.formItems[o].pagination.pageIndex=1,this.formItems[o].pagination.total=0,this.$set(this.formData,this.formItems[o].prop,u)}if("project_major"==this.formItems[o].prop){for(var w=[],C=e.majors,y=0;y<C.length;y++)w.push(C[y].mcode);this.$set(this.formData,this.formItems[o].prop,w)}if("Attach"==this.formItems[o].prop&&(this.formItems[o].show=!1,this.formItems[o].defaultList=[]),"Cover"==this.formItems[o].prop){this.formItems[o].show=!0,this.formItems[o].defaultList=[];var S=e.coverImg;if(S&&S.length>0){var L=S[0].file_url;this.formItems[o].listType,this.forMataAttachList(this.formItems[o].state,L,o)}}}this.initMajors(),console.info("--------------"),console.info(this.formItems),console.info(this.formData),this.formLoading=!1},forMataAttachList:function(e,t,o){var i=this;this.formItems[o].defaultList=[];var n={};n.response=a()({},e,t),n.status="success",n.file_caption=t,n.percentage="100",this.$nextTick(function(){i.formItems[o].defaultList.push(n)})},handleList:function(e){var t=this;console.info("handleList itemIndex = "+e),this.formItems[e].options.loading=!0,"brokers"==this.formItems[e].prop?Object(l.d)({params:{page:this.formItems[e].pagination.pageIndex,page_size:this.formItems[e].pagination.pageSize,search:this.formItems[e].searchText}}).then(function(o){o.detail?t.$message.error(o.detail):(t.formItems[e].total=o.data.count,t.formItems[e].pagination.total=Number(o.data.count),t.formItems[e].list=o.data.results,t.formItems[e].options.loading=!1)}):"requirements"==this.formItems[e].prop?Object(l.n)({params:{page:this.formItems[e].pagination.pageIndex,page_size:this.formItems[e].pagination.pageSize,search:this.formItems[e].searchText}}).then(function(o){o.detail?t.$message.error(o.detail):(t.formItems[e].total=o.data.count,t.formItems[e].pagination.total=Number(o.data.count),t.formItems[e].list=o.data.results,t.formItems[e].options.loading=!1)}):"results"==this.formItems[e].prop?Object(l.o)({params:{page:this.formItems[e].pagination.pageIndex,page_size:this.formItems[e].pagination.pageSize,search:this.formItems[e].searchText}}).then(function(o){o.detail?t.$message.error(o.detail):(t.formItems[e].total=o.data.count,t.formItems[e].pagination.total=Number(o.data.count),t.formItems[e].list=o.data.results,t.formItems[e].options.loading=!1)}):"experts"==this.formItems[e].prop&&Object(l.e)({params:{page:this.formItems[e].pagination.pageIndex,page_size:this.formItems[e].pagination.pageSize,search:this.formItems[e].searchText}}).then(function(o){if(o.detail)t.$message.error(o.detail);else{for(var i=[],a=0;a<o.data.results.length;a++){var n=o.data.results[a],s={serial:n.serial,expert_code:n.expert_code,expert_mobile:n.expert_mobile,expert_name:n.expert_name};i.push(s)}t.formItems[e].total=o.data.count,t.formItems[e].pagination.total=Number(o.data.count),t.formItems[e].list=i,t.formItems[e].options.loading=!1}})},initMajors:function(){var e=this;console.info("initMajors...");for(var t="",o=0;o<this.formItems.length;o++)if("project_major"==this.formItems[o].prop){t=o;break}this.formItems[t].loading=!0,Object(l.f)({params:{page:1,page_size:1e3}}).then(function(o){if(o.detail)e.$message.error(o.detail);else{for(var i=e.toTree(o.data.results),a=[],n=0;n<i.length;n++){var s=i[n],r={};r.label=s.mname;var l=s.children,m=[];if(l){for(var p=0;p<l.length;p++){var c=l[p],f={};f.value=c.mcode,f.label=c.mname,m.push(f)}r.options=m,a.push(r)}}for(var h=0;h<e.formItems.length;h++)"project_major"==e.formItems[h].prop&&(e.formItems[h].options=a);e.formItems[t].loading=!1}})},toTree:function(e){e.forEach(function(e){delete e.children});var t={};e.forEach(function(e){t[e.mcode]=e});var o=[];return e.forEach(function(e){var i=t[e.pmcode];i?(i.children||(i.children=[])).push(e):o.push(e)}),o}}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"warp-box"},[o("curmbs"),e._v(" "),o("div",{staticClass:"container"},[o("handleBox",{attrs:{handleConfig:e.handleConfig},on:{delAll:e.delAll,search:e.search,newItem:e.newItem}}),e._v(" "),o("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),o("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,formBtnList:"","before-close":e.handleClose,modal:!0,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("jsonForm",{ref:"formData",attrs:{handleType:e.handleType,formData:e.formData,rules:e.rules,formItems:e.formItems,formOptions:e.formOptions,formLoading:e.formLoading},on:{handleList:e.handleList,handleCofirm:e.handleCofirm,handleCancle:function(t){e.dialogFormVisible=!1}}})],1)],1)],1)},staticRenderFns:[]};var u=o("C7Lr")(h,d,!1,function(e){o("vTWJ")},"data-v-3a711e27",null);t.default=u.exports},pt5p:function(e,t){},qOHN:function(e,t){},vTWJ:function(e,t){}});