webpackJsonp([1],{"5+Ie":function(e,t){},"767d":function(e,t,r){"use strict";r.d(t,"c",function(){return s}),r.d(t,"a",function(){return n}),r.d(t,"d",function(){return i}),r.d(t,"b",function(){return l}),r.d(t,"e",function(){return p});var o=r("pxwZ"),a="/achievement/managementp/",s=function(e,t){return Object(o.c)(a+e+"/",t)},n=function(e){return Object(o.d)(a,e)},i=function(e){return Object(o.b)(a,e)},l=function(e){return Object(o.a)(a+e+"/")},p=function(e){return Object(o.b)(a+e+"/")}},"iz/m":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("ZLEe"),a=r.n(o),s=r("a3Yh"),n=r.n(s),i=r("aA9S"),l=r.n(i),p=r("D4TX"),c=r("GOyC"),h=r("R5Jg"),u=r("IkF9"),m=r("767d"),d=r("9pcb"),f=r("8V1Y"),g=n()({data:function(){var e=this;return{dialogTitle:"",pparamAll:[{value:0,label:"一级分类"}],dialogFormVisible:!1,serial:"",rules:{},currentEditLine:0,select_word:"",formData:{},handleType:"new",saveStartTime:"",handleOne:!0,formOptions:{labelWidth:"160px"},formItems:[{prop:"r_name",label:"成果名称",type:"input",rules:[{required:!0,message:"该项为必填项",trigger:"blur"}],eleProps:{placeholder:"请填写成果名称"}},{prop:"r_form_type",label:"形式类型",type:"select",rules:[{required:!0,message:"请选择形式类型",trigger:"blur",type:"number"}],change:function(t){e.patentNum(t)},eleProps:{placeholder:"请填写参数名称"},options:f.a.resultTypeOptions},{prop:"r_abstract",label:"成果简介",type:"input",rules:[{required:!0,message:"该项为必填项",trigger:"blur"}],eleProps:{placeholder:"请填写参数描述",type:"textarea"}},{prop:"use_type",label:"成果使用方式",type:"select",rules:[{required:!0,message:"该项为必选项",trigger:"change",type:"number"}],eleProps:{placeholder:"填写参数值"},options:f.a.resultUseTypeOptions},{prop:"obtain_type",label:"成果信息获取方式",type:"select",$default:2,eleProps:{placeholder:"填写参数值"},change:function(t){e.changeAttach(t)},options:f.a.resultObtainTypeOptions},{prop:"osource_name",label:"成果获取来源名称",type:"input",eleProps:{placeholder:"填写参数值"}},{prop:"entry_type",label:"信息录入方式",type:"select",rules:[{required:!0,message:"该项为必选项",trigger:"change",type:"number"}],eleProps:{placeholder:"填写参数值"},options:f.a.entryTypeOptions},{prop:"owner_type",label:"持有人类型",type:"select",change:function(t){e.changeUpload(t)},$default:1,eleProps:{placeholder:"填写参数值"},options:f.a.ownerTypeOptions},{prop:"cooperation_name",label:"合作方式名称",type:"select",rules:[{required:!0,message:"该项为必选项",trigger:"change",type:"number"}],eleProps:{placeholder:"合作方式名称"},options:f.a.methodType},{prop:"owner_abstract",label:"持有人相关描述",type:"input",eleProps:{placeholder:"请填写持有人相关描述"}},{prop:"r_coop_t_abstract",label:"合作方式简述",type:"input",eleProps:{placeholder:"请填写简述"}},{prop:"expiry_dateb",label:"授权合作开始时间",type:"date-picker",rules:[{required:!0,message:"该项为必选项",trigger:"change"}],eleProps:{placeholder:"选择开始时间",type:"date",valueFormat:"yyyy-MM-dd HH:mm:ss"}},{prop:"expiry_datee",label:"授权合作结束时间",type:"date-picker",rules:[{required:!0,message:"该项为必选项",trigger:"change"}],eleProps:{placeholder:"选择结束时间",type:"date",valueFormat:"yyyy-MM-dd HH:mm:ss",pickerOptions:{minTime:"expiry_dateb"}}},{prop:"show_state",label:"成果状态",type:"select",rules:[{required:!0,message:"该项为必填项",trigger:"change",type:"number"}],options:f.a.showStateOptions},{prop:"r_abstract_detail",label:"成果详情",type:"editor",$default:"",eleProps:{placeholder:"填写参数值"},defaultValue:""},{prop:"Keywords",label:"关键字",type:"input",$default:"",rules:[{required:!0,message:"请输入关键词",trigger:"blur"}],eleProps:{placeholder:"多个关键字之间用逗号分隔"}},{prop:"patent_number",label:"专利/论文编号",type:"input",show:!0,rules:[{required:!0,message:"请输入专利/论文编号",trigger:"blur",type:"string"}],eleProps:{placeholder:"请输入专利/论文编号"}},{prop:"mname",label:"所属领域",type:"select",$default:[],rules:[{required:!0,message:"该项为必填项",trigger:"change",type:"array"}],eleProps:{placeholder:"选择所属领域代码",filterable:!0,multiple:!0,collapseTags:!0},options:[]},{prop:"account_code",label:"帐号",type:"select",$default:null,rules:[{required:!0,message:"该项为必填项",trigger:"change",type:"string"}],eleProps:{placeholder:"帐号"},change:function(t){e.postPerson(t)},options:[]},{prop:"Personal",label:"个人基本信息",type:"select",$default:"",rules:[{required:!0,message:"该项为必填项",trigger:"blur"}],show:!0,eleProps:{placeholder:"选择个人基本信息代码"},options:[]},{prop:"Enterprise",label:"企业基本信息",type:"select",$default:"",rules:[{required:!0,message:"该项为必填项",trigger:"blur"}],show:!0,eleProps:{placeholder:"选择企业基本信息代码"},options:[]},{prop:"Attach",label:"附件",type:"upload",state:"attachment",defaultList:[],limitNum:9,$default:null,listType:"text",icon:r("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.PDF,.DOC,.DOCX,.XLS,.XLSX,.zip,.rar,RAR,.jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"附件"}},{prop:"Cover",label:"封面",type:"upload",defaultList:[],$default:null,state:"Cover",listType:"picture",icon:r("6pu8"),acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"封面"}},{prop:"PerIdFront",label:"身份证正面",type:"upload",defaultList:[],$default:null,listType:"picture",state:"PerIdFront",icon:r("qkrN"),rules:[{required:!0,message:"该项为必填项",trigger:"change"}],show:!1,acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"身份证正面"}},{prop:"PerIdBack",label:"身份证反面",type:"upload",defaultList:[],$default:null,listType:"picture",state:"PerIdBack",icon:r("Kyb6"),show:!1,rules:[{required:!0,message:"该项为必填项",trigger:"change"}],acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"身份证反面"}},{prop:"PerHandId",label:"手持身份证",type:"upload",defaultList:[],$default:null,listType:"picture",state:"PerHandId",icon:r("knSM"),show:!1,rules:[{required:!0,message:"该项为必填项",trigger:"change"}],acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"身份证反面"}},{prop:"AgencyImg",label:"协议图片",type:"upload",defaultList:[],$default:null,listType:"picture",state:"AgencyImg",icon:r("6pu8"),show:!0,rules:[{required:!0,message:"该项为必填项",trigger:"change"}],acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"身份证反面"}},{prop:"EntLicense",label:"营业执照",type:"upload",defaultList:[],$default:null,listType:"picture",state:"EntLicense",icon:r("fB8s"),show:!1,rules:[{required:!0,message:"该项为必填项",trigger:"change"}],acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"身份证反面"}}],handleConfig:{searchTerms:[{value:"r_name",label:"成果名称"}],newItemTxt:"新增成果",delBtn:!1,auditBtn:!1},total:0,list:[],fileList:[],columns:[{prop:"r_name",label:"成果名称",align:"center",width:180},{prop:"r_form_type",label:"形式类型",align:"center",width:180,formatter:function(e,t,r){return f.a.resultType_arr[e[t.prop]]}},{prop:"use_type",label:"使用方式",align:"center",width:"160",formatter:function(e,t,r){return f.a.resultUseType_arr[e[t.prop]]}},{prop:"show_state",label:"展示状态",align:"center",width:"160",render:function(e,t){return e("el-tag",{props:{type:1===t.row.show_state?"success":4===t.row.show_state?"info":"danger"}},f.a.showState_arr[t.row.show_state])}},{prop:"obtain_type",label:"获取方式",align:"center",width:180,formatter:function(e,t,r){return f.a.resultObtainType_arr[e[t.prop]]}},{prop:"osource_name",label:"来源名称",align:"center",width:180},{prop:"entry_type",label:"录入方式",align:"center",width:180,formatter:function(e,t,r){return f.a.entryType_arr[e[t.prop]]}},{prop:"owner_type",label:"持有人类型",align:"center",width:180,formatter:function(e,t,r){return f.a.ownerType_arr[e[t.prop]]}},{prop:"expiry_dateb",label:"授权开始",align:"center",width:180},{prop:"expiry_datee",label:"授权结束",align:"center",width:180},{prop:"insert_time",label:"创建时间",align:"center",width:180}],operates:{width:300,fixed:"right",list:[{label:"详情",type:"primary",show:function(e,t){return!0},icon:"el-icon-info",plain:!0,disabled:!1,method:function(t,r){e.handleDetail(t,r)}},{label:"编辑",type:"warning",show:function(e,t){return!0},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,r){e.handleEdit(t,r)}},{label:"删除",type:"danger",icon:"el-icon-delete",show:!0,plain:!1,disabled:!1,method:function(t,r){e.handleDel(t,r)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!0}}},components:{jsonForm:u.a,curmbs:p.a,handleBox:c.a,opTable:h.a},computed:{},mounted:function(){this.getAccount()},watch:{formData:{handler:function(e,t){e.obtain_type,t.obtain_type}}},methods:{delAll:function(){},search:function(e,t){this.select_word=t,this.getList()},getList:function(){var e=this;this.options.loading=!0,Object(m.d)({params:{page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word}}).then(function(t){e.total=t.data.count,e.pagination.total=Number(t.data.count),e.list=t.data.results,e.options.loading=!1})},newItem:function(){this.resetExtrForm(),this.dialogTitle="新增成果",this.currentEditLine=0,this.handleType="new",this.dialogFormVisible=!0},resetExtrForm:function(){var e=this;this.formItems.forEach(function(t,r){e.$set(e.formData,t.prop,t.$default),"obtain_type"==t.prop&&e.changeAttach(t.$default),"owner_type"==t.prop&&e.changeUpload(t.$default),t.state&&(t.defaultList=[]),void 0!==t.defaultValue&&e.$nextTick(function(){t.defaultValue=null})})},handleClose:function(e){this.$refs.formmodel.resetForm(),e()},handleCofirm:function(e){var t=this;if(!this.$refs.formmodel.validateForm())return!1;if("edit"==this.handleType){var r=new Date,o=this.timeDisposal(r),a=e.expiry_dateb,s=e.expiry_datee;if(a===this.saveStartTime)console.log("没改过时间");else if(a<o)return this.$message.warning("开始时间不得小于当前时间");if(s<a)return this.$message.warning("结束时间不得小于开始时间");null!=e.Attach&&e.Attach.length>0&&e.Attach[0].response&&(e.Attach=this.Attch(e.Attach)),Object(m.c)(this.serial,e).then(function(e){e.detail?t.$message.error(e.detail):(t.list.splice(t.currentEditLine,1,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"编辑成功!"}),t.getList())})}else{console.log(e.Attach),e.r_code&&delete e.r_code;var n=new Date,i=this.timeDisposal(n),l=e.expiry_dateb,p=e.expiry_datee;if(l<i)return this.$message.warning("开始时间不得小于当前时间");if(p<l)return this.$message.warning("结束时间不得小于开始时间");null!=e.Attach&&e.Attach.length>0&&e.Attach[0].response&&(e.Attach=this.Attch(e.Attach)),null!=e.Cover&&(e.Cover=this.Cover(e)),null!=e.PerHandId&&(e.Cover=this.Cover(e)),Object(m.a)(e).then(function(e){e.detail?t.$message.error(e.detail):(t.list.splice(0,0,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加成功!"}),t.getList())})}},handleEdit:function(e,t){var r=this;this.resetExtrForm(),this.handleOne=!1,this.currentEditLine=t,this.dialogTitle="编辑成果信息",this.handleType="edit",this.serial=e.serial,this.dialogFormVisible=!0,this.formData=l()({},e),this.saveStartTime=e.expiry_dateb,this.formItems.forEach(function(t,o){void 0!==t.defaultValue&&(r.$nextTick(function(){"寻求资金"==e.cooperation_name?r.formData.cooperation_name=1:"市场推广"==e.cooperation_name?r.formData.cooperation_name=2:"方案落地"==e.cooperation_name?r.formData.cooperation_name=3:r.formData.cooperation_name=4,3==e.obtain_type&&(r.formData.obtain_type=2),r.$set(t,"defaultValue",e[t.prop])}),r.changeAttach(r.formData.obtain_type),r.changeUpload(r.formData.owner_type),r.patentNum(r.formData.r_form_type)),t.state&&""!=e[t.prop]&&null!=e[t.prop]&&("picture"==t.listType?r.forMataFileList(t.state,e[t.prop],o):r.forMataAttachList(t.state,e[t.prop],o))})},forMataFileList:function(e,t,r){var o=this,a={};a.response=n()({},e,t),a.status="success",a.percentage="100",this.$nextTick(function(){o.formItems[r].defaultList.splice(0,1,a)})},forMataAttachList:function(e,t,r){var o=this;if(this.formItems[r].defaultList=[],t.length)for(var a=function(a){var s={};s.response=n()({},e,[t[a].down]),s.status="success",s.file_caption=t[a].file_caption,s.percentage="100",o.$nextTick(function(){o.formItems[r].defaultList.push(s)})},s=0;s<t.length;s++)a(s)},handleSizeChange:function(e){this.pagination=e,console.log("handleSizeChange:"+this.pagination.pageSize),this.getList()},handleIndexChange:function(e){this.pagination=e,console.log("handleIndexChange:"+this.pagination.pageIndex),this.getList()},handleSelectionChange:function(e){},handleDetail:function(e,t){this.$router.push({name:"result_detail",query:{serial:e.serial}})},handleDel:function(e,t){var r=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(m.b)(e.serial).then(function(e){e.detail?r.$message.error(e.detail):r.list.splice(t,1)}).then(function(){r.$message({type:"success",message:"删除成功!"})})}).catch(function(){r.$message({type:"info",message:"已取消删除"})})},getAccount:function(){var e=this;Object(d.a)().then(function(t){for(var r=[],o=0;o<t.data.results.length;o++){var a={};null!=t.data.results[o].user_name&&(a.value=t.data.results[o].account_code,a.label=t.data.results[o].user_name,a.key=o,r.push(a))}for(var s in e.formItems)"account_code"==e.formItems[s].prop&&(e.formItems[s].options=r)},function(e){}),Object(d.h)().then(function(t){for(var r=[],o=0;o<t.data.results.length;o++){var a={};null!=t.data.results[o].mname&&(a.value=t.data.results[o].mname,a.label=t.data.results[o].mname,a.key=o,r.push(a))}for(var s in e.formItems)"mname"==e.formItems[s].prop&&(e.formItems[s].options=r)},function(e){})},Attch:function(e){for(var t=[],r=[],o=0;o<e.length;o++)r=a()(e[o].response),t.push(e[o].response[r][0]);return t},Cover:function(e){for(var t={},r=0;r<this.formItems.length;r++)if("upload"==this.formItems[r].type){var o=this.formItems[r].prop;if("Attach"!=o){var a=null;a=e[o]?e[o]:null,t[o="Cover"==o?"coverImg":"PerIdBack"==o?"identityBack":"PerHandId"==o?"handIdentityPhoto":"PerIdFront"==o?"identityFront":"EntLicense"==o?"entLicense":"agreement"]=a}}return t},getenterprise:function(e){var t=this;Object(d.l)(e).then(function(e){for(var r=[],o=0;o<e.data.results.length;o++){var a={};null!=e.data.results[o].ename&&(a.value=e.results[o].ecode,a.label=e.results[o].ename,a.key=o,r.push(a))}if(1==t.formData.obtain_type)"new"==t.handleType&&(t.formData.Enterprise="");else for(var s in t.formItems)"Enterprise"==t.formItems[s].prop&&1==t.formItems[s].show&&(t.formData.Enterprise=r[0].value);for(var n in t.formItems)"Enterprise"==t.formItems[n].prop&&(t.formItems[n].options=r)},function(e){})},getelperson:function(e){var t=this;Object(d.k)(e).then(function(e){for(var r=[],o=0;o<e.data.results.length;o++){var a={};null!=e.data.results[o].pname&&(a.value=e.data.results[o].pcode,a.label=e.data.results[o].pname,a.key=o,r.push(a))}if(1==t.formData.obtain_type)"new"==t.handleType&&(t.formData.Personal="");else for(var s in t.formItems)"Personal"==t.formItems[s].prop&&1==t.formItems[s].show&&(t.formData.Personal=r[0].value);for(var n in t.formItems)"Personal"==t.formItems[n].prop&&(t.formItems[n].options=r)},function(e){})},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},timeDisposal:function(e){var t=e.getFullYear(),r=e.getMonth()+1,o=e.getDate(),a=e.getHours(),s=e.getMinutes(),n=e.getSeconds(),i=this.ifNotZero(r),l=this.ifNotZero(o);this.ifNotZero(a),this.ifNotZero(s),this.ifNotZero(n);return t+"-"+i+"-"+l+" 00:00:00"},ifNotZero:function(e){return e<10&&(e="0"+e),e},patentNum:function(e){if(3==e)for(var t=0;t<this.formItems.length;t++)"patent_number"==this.formItems[t].prop&&void 0!=this.formItems[t].show&&(this.formItems[t].show=!1)},changeAttach:function(e){for(var t=this,r="",o=0;o<this.formItems.length;o++)1==e&&("upload"==this.formItems[o].type&&void 0!=this.formItems[o].show&&(this.formItems[o].show=!0),"Personal"==this.formItems[o].prop&&this.formItems[o].show,"Enterprise"==this.formItems[o].prop&&this.formItems[o].show),2==e&&("Personal"==this.formItems[o].prop&&this.formItems[o].show,"Enterprise"==this.formItems[o].prop&&this.formItems[o].show,"upload"==this.formItems[o].type&&void 0!=this.formItems[o].show&&(this.formItems[o].show=!1));1==e?(r="page_size=max",this.getelperson(r),this.getenterprise(r)):null==this.formData.account_code||(r="search="+this.formData.account_code,this.getelperson(r),this.getenterprise(r)),this.$nextTick(function(){t.changeUpload(t.formData.owner_type)})},changeUpload:function(e){e=this.formData.owner_type;for(var t=0;t<this.formItems.length;t++)2==e?(1==this.formData.obtain_type&&"EntLicense"==this.formItems[t].prop&&void 0!=this.formItems[t].show&&(this.formItems[t].show=!0),"Enterprise"==this.formItems[t].prop&&void 0!=this.formItems[t].show&&(this.formItems[t].show=!0),"Personal"==this.formItems[t].prop&&void 0!=this.formItems[t].show&&(this.formItems[t].show=!1)):("Enterprise"==this.formItems[t].prop&&void 0!=this.formItems[t].show&&(this.formItems[t].show=!1),"Personal"==this.formItems[t].prop&&void 0!=this.formItems[t].show&&(this.formItems[t].show=!0))},postPerson:function(e){for(var t="",r=0;r<this.formItems.length;r++)if("obtain_type"==this.formItems[r].prop)if(1==this.formData.obtain_type)t="page_size=max",console.log(t);else{t="search="+(""!=this.formData.account_code?this.formData.account_code:e),console.log(t),console.log(this.formItems[r].prop)}this.getelperson(t),this.getenterprise(t)}}},"computed",{}),y={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"warp-box"},[r("curmbs"),e._v(" "),r("div",{staticClass:"container"},[r("handleBox",{attrs:{handleConfig:e.handleConfig},on:{delAll:e.delAll,search:e.search,newItem:e.newItem}}),e._v(" "),r("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),r("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"before-close":e.handleClose,modal:!1,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("jsonForm",{ref:"formmodel",attrs:{handleType:e.handleType,formData:e.formData,formItems:e.formItems,formOptions:e.formOptions},on:{handleCofirm:e.handleCofirm,handleCancle:function(t){e.dialogFormVisible=!1}}})],1)],1)],1)},staticRenderFns:[]};var b=r("C7Lr")(g,y,!1,function(e){r("5+Ie")},"data-v-31ef2d38",null);t.default=b.exports}});