webpackJsonp([53],{"3slT":function(e,t){},"9ze8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n("D4TX"),i=n("GOyC"),a=n("R5Jg"),o=n("93JQ"),s=n("ErsD"),r={data:function(){var e=this;return{state_arr:{0:"待审核",1:"通过",2:"未通过",3:"发起者放弃",5:"草稿"},dialogTitle:"",dialogFormVisible:!1,serial:"",rules:{consult_title:[{required:!0,message:"请输入征询标题",trigger:"blur"},{min:2,max:60,message:"长度在 2 到 60 个字符",trigger:"blur"}],consult_memo:[{required:!0,message:"请输入征询简述",trigger:"blur"},{min:200,max:2e3,message:"长度在 200 到 2000 个字符",trigger:"blur"}],consult_body:[{required:!0,message:"请输入征询详细内容",trigger:"blur"}]},currentEditLine:0,select_word:"",formData:{},handleType:"new",formBtnList:[{label:"取消",type:"info",show:!1,icon:"",plain:!0,disabled:!1,method:"handleCancle"},{label:"提交",type:"success",icon:"",show:!0,plain:!1,disabled:!1,method:"handleCofirm"}],formOptions:{labelWidth:"120px"},formItems:[{prop:"consult_title",text:"标题",label:"标题",type:"input",eleProps:{placeholder:"请填写标题"}},{prop:"consult_memo",text:"简述",label:"简述",type:"input",eleProps:{placeholder:"请输入简述",type:"textarea"}},{prop:"consult_body",text:"详细内容",label:"详细内容",type:"input",eleProps:{placeholder:"请输入详细内容",type:"textarea",disabled:!0}},{prop:"consult_time",text:"发起时间",label:"发起时间",type:"input",eleProps:{placeholder:"请输入发起时间",disabled:!0}},{prop:"consult_endtime",text:"结束时间",label:"结束时间",type:"input",eleProps:{placeholder:"请输入结束时间",disabled:!0}},{prop:"rr",text:"成果需求",label:"成果需求",type:"input",eleProps:{placeholder:"成果或需求",type:"textarea",disabled:!0}},{prop:"consult_state",text:"状态",label:"状态",type:"select",eleProps:{placeholder:"请选择状态",disabled:!0},options:[{value:0,label:"待审核"},{value:1,label:"通过"},{value:2,label:"未通过"},{value:3,label:"发起者放弃"},{value:5,label:"草稿"}]},{prop:"insert_time",text:"创建时间",label:"创建时间",type:"input",eleProps:{placeholder:"请输入创建时间",disabled:!0}}],handleConfig:{searchTerms:[{value:"consult_title",label:"征询标题"},{value:"consult_memo",label:"征询简述"}],delBtn:!1,newItemTxt:"",auditBtn:!1},total:0,list:[],columns:[{prop:"consult_title",label:"标题",align:"center",width:180},{prop:"rr",label:"成果或需求",align:"center",width:120,formatter:function(e,t,n){return e.rr.join()}},{prop:"account",label:"征询人",align:"center",width:120},{prop:"consult_state",label:"状态",align:"center",width:"160",render:function(t,n){return t("el-tag",{props:{type:2===n.row.consult_state?"danger":1===n.row.consult_state?"success":"info"}},e.state_arr[n.row.consult_state])}},{prop:"consult_time",label:"开始时间",align:"center",width:160},{prop:"consult_endtime",label:"结束时间",align:"center",width:240},{prop:"insert_time",label:"创建时间",align:"center",width:180}],operates:{width:300,fixed:"right",list:[{label:"编辑",type:"warning",show:function(e,t){return!0},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,n){e.handleEdit(t,n)}},{label:"删除",type:"danger",icon:"el-icon-delete",show:!0,plain:!1,disabled:!1,method:function(t,n){e.handleDel(t,n)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!0}}},components:{jsonForm:o.a,curmbs:l.a,handleBox:i.a,opTable:a.a},methods:{handleClose:function(e){this.$refs.formData.handleCancle(),e()},handleCofirm:function(e){var t=this;if(!this.$refs.formData.validateForm())return!1;Object(s.b)(this.serial,e).then(function(e){e.detail?t.$message.error(e.detail):(t.list.splice(t.currentEditLine,1,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"编辑成功!"}))})},search:function(e,t){this.select_word=t,this.getList()},delAll:function(){console.log("delAll")},getList:function(){var e=this;this.options.loading=!0,Object(s.c)({params:{page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word}}).then(function(t){e.total=t.data.count,e.pagination.total=Number(t.data.count),e.list=t.data.results,e.options.loading=!1})},handleSizeChange:function(e){this.pagination=e,this.getList()},handleIndexChange:function(e){this.pagination=e,this.getList()},handleSelectionChange:function(e){},handleDetail:function(e,t){this.$router.push({name:"consult_detail",query:{serial:e.serial}})},handleEdit:function(e,t){this.currentEditLine=t,this.dialogTitle="编辑征询信息",this.handleType="edit",this.serial=e.serial,this.rowData=e;for(var n=0;n<this.formItems.length;n++)void 0!==e[this.formItems[n].prop]&&(e[this.formItems[n].prop]?this.$set(this.formData,this.formItems[n].prop,e[this.formItems[n].prop]):this.$set(this.formData,this.formItems[n].prop,""));this.dialogFormVisible=!0},handleDel:function(e,t){var n=this;this.$confirm("此操作将永久删除该征询, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)(e.serial).then(function(e){e.detail?n.$message.error(e.detail):n.list.splice(t,1)}).then(function(){n.$message({type:"success",message:"删除成功!"})})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"warp-box"},[n("curmbs"),e._v(" "),n("div",{staticClass:"container"},[n("handleBox",{attrs:{handleConfig:e.handleConfig},on:{delAll:e.delAll,search:e.search}}),e._v(" "),n("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),n("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"before-close":e.handleClose,modal:!1,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("jsonForm",{ref:"formData",attrs:{formBtnList:e.formBtnList,handleType:e.handleType,formData:e.formData,rules:e.rules,formItems:e.formItems,formOptions:e.formOptions},on:{handleCancle:function(t){e.dialogFormVisible=!1},handleCofirm:e.handleCofirm}})],1)],1)],1)},staticRenderFns:[]};var d=n("C7Lr")(r,c,!1,function(e){n("3slT")},"data-v-77af0560",null);t.default=d.exports},ErsD:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return r});var l=n("pxwZ"),i="/consult/consult_info/",a=function(e,t){return Object(l.c)(i+e+"/",t)},o=function(e){return Object(l.b)(i,e)},s=function(e){return Object(l.b)(i+e+"/")},r=function(e){return Object(l.a)(i+e+"/")}}});