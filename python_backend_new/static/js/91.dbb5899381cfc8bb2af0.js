webpackJsonp([91],{WIR9:function(e,t){},ugf9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("a3Yh"),i=a.n(l),r=a("aA9S"),s=a.n(r),n=a("D4TX"),o=a("GOyC"),p=a("R5Jg"),c=a("IkF9"),d=(a("8V1Y"),a("vmLM")),u={data:function(){var e=this;return{group_arr:[],del_selected:[],accountAll:[],persons:[],state_arr:{1:"可显示",0:"不可显示"},dialogTitle:"",dialogFormVisible:!1,serial:"",currentEditLine:0,select_word:"",formData:{},handleType:"new",formOptions:{labelWidth:"200px"},formItems:[{prop:"caption",text:"政策法规主标题",label:"政策法规主标题",$default:null,type:"input",eleProps:{placeholder:"请输入政策法规主标题",maxlength:64},rules:[{required:!0,message:"请输入政策法规主标题",trigger:"change"},{min:1,max:64,message:"长度在1到64个字符",trigger:"blur"}]},{prop:"group_code",text:"政策法规所属栏目",label:"政策法规所属栏目",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择政策法规所属栏目"},options:[{value:1,label:"可显示"},{value:0,label:"不可显示"}],rules:[{required:!0,message:"请选择政策法规所属栏目",trigger:"change"}]},{prop:"caption_ext",text:"政策法规副标题",label:"政策法规副标题",$default:null,type:"input",eleProps:{placeholder:"政策法规副标题",maxlength:64},rules:[{required:!0,message:"请输入政策法规副标题",trigger:"change"},{min:1,max:64,message:"政策法规副标题长度在1到64个字符",trigger:"blur"}]},{prop:"author",text:"作者名称",label:"作者名称",$default:null,type:"input",eleProps:{placeholder:"作者名称",maxlength:20},rules:[{required:!0,message:"请输入作者名称",trigger:"change"},{min:1,max:20,message:"作者名称长度在1到20个字符",trigger:"blur"}]},{prop:"publisher",text:"发行单位",label:"发行单位",$default:null,type:"input",eleProps:{placeholder:"发行单位",maxlength:64},rules:[{required:!0,message:"请输入发行单位",trigger:"change"},{min:1,max:32,message:"发行单位长度在1到32个字符",trigger:"blur"}]},{prop:"source",text:"政策法规来源",label:"政策法规来源",$default:null,type:"input",eleProps:{placeholder:"政策法规来源",maxlength:64},rules:[{maxlength:255,pattern:/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/,message:"政策法规来源url不正确",trigger:"blur"}]},{prop:"top_tag",text:"置顶",label:"置顶",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择是否置顶"},options:[{value:1,label:"置顶"},{value:0,label:"不置顶"}],rules:[{required:!0,message:"请选择是否置顶",trigger:"change"}]},{prop:"top_time",text:"置顶时间",label:"置顶时间",$default:null,type:"onlytime",eleProps:{placeholder:"置顶时间"}},{prop:"district_id",text:"所属地理区域",label:"所属地理区域",$default:null,type:"selectregion",eleProps:{placeholder:"请选择所属地理区域"},rules:[{required:!0,message:"请选择所属地理区域",trigger:"change"}]},{prop:"state",text:"状态",label:"状态",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择状态"},options:[{value:1,label:"可显示"},{value:0,label:"不可显示"}],rules:[{required:!0,message:"请选择状态",trigger:"change"}]},{type:"upload",prop:"face_pic",label:"政策法规导引图",defaultList:[],$default:null,limitNum:1,listType:"pictures",state:"face_pic",icon:a("6pu8"),acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"政策法规导引图"}},{prop:"news_body",text:"政策法规详情",label:"政策法规详情",$default:null,type:"editor",defaultValue:"",apiUrl:"",eleProps:{maxlength:65535},rules:[{required:!0,message:"请填写政策法规详情",trigger:"change"}]},{type:"upload",prop:"attach1",label:"附件1(word,excel,pdf,zip)",defaultList:[],$default:null,state:"attachment",listType:"text",icon:a("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.pdf,.DOC,.DOCX,.XLS,.XLSX,.PDF,.zip,.ZIP",eleProps:{placeholder:"附件1"},method:"successUpload"},{type:"upload",prop:"attach2",label:"附件2(word,excel,pdf,zip)",defaultList:[],$default:null,state:"attachment",listType:"text",icon:a("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.pdf,.DOC,.DOCX,.XLS,.XLSX,.PDF,.zip,.ZIP",eleProps:{placeholder:"附件2"},method:"successUpload"},{type:"upload",prop:"attach3",label:"附件3(word,excel,pdf,zip)",defaultList:[],$default:null,state:"attachment",listType:"text",icon:a("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.pdf,.DOC,.DOCX,.XLS,.XLSX,.PDF,.zip,.ZIP",eleProps:{placeholder:"附件3"},method:"successUpload"},{type:"upload",prop:"attach4",label:"附件4(word,excel,pdf,zip)",defaultList:[],$default:null,state:"attachment",listType:"text",icon:a("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.pdf,.DOC,.DOCX,.XLS,.XLSX,.PDF,.zip,.ZIP",eleProps:{placeholder:"附件4"},method:"successUpload"},{type:"upload",prop:"attach5",label:"附件5(word,excel,pdf,zip)",defaultList:[],$default:null,state:"attachment",listType:"text",icon:a("pFwa"),acceptType:".doc,.docx,.xls,.xlsx,.pdf,.DOC,.DOCX,.XLS,.XLSX,.PDF,.zip,.ZIP",eleProps:{placeholder:"附件5"},method:"successUpload"}],handleConfig:{searchTerms:[{value:"caption",label:"政策法规主标题"}],newItemTxt:"创建政策法规",auditBtn:!1},total:0,list:[],columns:[{prop:"caption",label:"政策法规主标题",align:"center",width:180},{prop:"group_code",label:"政策法规所属栏目",align:"center",width:180,formatter:function(e,t,a){return e.group_name}},{prop:"caption_ext",label:"政策法规副标题",align:"center",width:180},{prop:"state",label:"状态",align:"center",width:"160",render:function(t,a){return t("el-tag",{props:{type:0===a.row.state?"danger":1===a.row.state?"success":"info"}},e.state_arr[a.row.state])}},{prop:"district_id",label:"政策法规所属地区",align:"center",width:180,formatter:function(e,t,a){return e.district_name}},{prop:"face_pic",label:"政策法规导引图",align:"center",width:350,formatter:function(e,t,a){if(e.face_pic)return'<img src="'+e.face_pic_path+e.face_pic+'" style="max-width:200px;max-height:120px;">'}},{prop:"author",label:"作者名称",align:"center",width:180},{prop:"publisher",label:"发行单位",align:"center",width:180},{prop:"release_date",label:"发布时间",align:"center",width:180}],operates:{width:300,fixed:"right",list:[{label:"详情",type:"primary",show:function(e,t){return!0},icon:"el-icon-info",plain:!0,disabled:!1,method:function(t,a){e.handleDetail(t,a)}},{label:"编辑",type:"warning",show:function(e,t){return!0},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,a){e.handleEdit(t,a)}},{label:"删除",type:"danger",icon:"el-icon-delete",show:!0,plain:!1,disabled:!1,method:function(t,a){e.handleDel(t,a)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!0,index:!0,maxHeight:1200}}},components:{jsonForm:c.a,curmbs:n.a,handleBox:o.a,opTable:p.a},methods:{handleCancle:function(){this.$refs.formData.resetForm(),this.dialogFormVisible=!1},handleClose:function(e){this.$refs.formData.resetForm(),e()},handleOpen:function(){this.$refs.formData.initSelect()},handleCofirm:function(e){var t=this;if(!this.$refs.formData.validateForm())return!1;"edit"==this.handleType?Object(d.g)(this.serial,e).then(function(e){if(e.detail)return t.$message.error(e.detail),!1;t.list.splice(t.currentEditLine,1,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"编辑成功!"}),t.getList()}):Object(d.a)(e).then(function(e){if(e.detail)return t.$message.error(e.detail),!1;t.list.splice(0,0,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加成功!"}),t.getList()})},handleEdit:function(e,t){var a=this;this.resetExtrForm(),this.getPolicyGroup(),this.currentEditLine=t,this.dialogTitle="编辑政策法规信息",this.handleType="edit",this.serial=e.serial,this.dialogFormVisible=!0,this.formData=s()({},e),this.formData.face_pic&&this.formData.face_pic_path&&(this.formData.face_pic=e.face_pic_path+e.face_pic),this.formItems.forEach(function(t,l){t.state&&e[t.prop]&&("text"==t.listType?a.forMataAttachList(t.state,a.formData[t.prop],l):a.forMataFileList(t.state,a.formData.face_pic,l)),void 0!==t.defaultValue&&a.$nextTick(function(){a.$set(t,"defaultValue",e[t.prop])})})},forMataAttachList:function(e,t,a){var l=this;if(this.formItems[a].defaultList=[],t.length)for(var r=function(r){var s={};s.response="attachment"==e?i()({},e,[t[r].down]):i()({},e,t[r].down),s.status="success",s.file_caption=t[r].file_caption,s.percentage="100",l.$nextTick(function(){l.formItems[a].defaultList.push(s)})},s=0;s<t.length;s++)r(s)},forMataFileList:function(e,t,a){var l=this,r={};r.response=i()({},e,t),r.status="success",r.percentage="100",this.$nextTick(function(){l.formItems[a].defaultList.splice(0,1,r)})},resetExtrForm:function(){var e=this;this.formItems.forEach(function(t,a){e.$set(e.formData,t.prop,t.$default),t.state&&(t.defaultList=[]),void 0!==t.defaultValue&&e.$nextTick(function(){t.defaultValue=null})})},newItem:function(){this.resetExtrForm(),this.dialogTitle="新增政策法规",this.currentEditLine=0,this.handleType="new",this.dialogFormVisible=!0,this.getPolicyGroup()},getPolicyGroup:function(){var e=this;Object(d.k)({params:{pageSize:"max",state:1}}).then(function(t){for(var a in e.group_arr=[],t.data.results)e.group_arr.push({value:t.data.results[a].group_code,label:t.data.results[a].group_name});for(var a in e.formItems)"group_code"==e.formItems[a].prop&&e.$set(e.formItems[a],"options",e.group_arr)})},search:function(e,t){this.select_word=t,this.pagination.pageIndex=1,this.getList()},getList:function(){var e=this;this.options.loading=!0,Object(d.i)({params:{page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word}}).then(function(t){e.total=t.data.count,e.pagination.total=Number(t.data.count),e.list=t.data.results,e.options.loading=!1})},handleSizeChange:function(e){this.pagination=e,this.getList()},handleIndexChange:function(e){this.pagination=e,this.getList()},handleSelectionChange:function(e){var t=new Array;for(var a in e)t.push(e[a].serial);this.del_selected=t},handleDetail:function(e,t){this.$router.push({name:"policy_detail",query:{serial:e.serial}})},handleDel:function(e,t){var a=this;this.$confirm("此操作将删除该政策法规是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.e)(e.serial).then(function(e){if(e.detail)return a.$message.error(e.detail),!1;a.list.splice(t,1)}).then(function(){a.$message({type:"success",message:"删除成功!"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},delAll:function(){var e=this;if(0==this.del_selected.length)return this.$message({type:"error",message:"请选择要批量删除的政策法规!"}),!1;var t=this.del_selected.shift();Object(d.c)(t,{data:this.del_selected}).then(function(t){if(t.detail)return e.$message.error(t.detail),!1;e.dialogFormVisible=!1,e.$message({type:"success",message:"批量删除成功!",duration:500,onClose:function(){window.location.reload()}})})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"warp-box"},[a("curmbs"),e._v(" "),a("div",{staticClass:"container"},[a("handleBox",{attrs:{handleConfig:e.handleConfig},on:{delAll:e.delAll,search:e.search,newItem:e.newItem}}),e._v(" "),a("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),a("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"before-close":e.handleClose,modal:!1,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t},opened:e.handleOpen}},[a("jsonForm",{ref:"formData",attrs:{handleType:e.handleType,formData:e.formData,formItems:e.formItems,formOptions:e.formOptions},on:{handleCancle:e.handleCancle,handleCofirm:e.handleCofirm}})],1)],1)],1)},staticRenderFns:[]};var f=a("C7Lr")(u,h,!1,function(e){a("WIR9")},"data-v-0e071c38",null);t.default=f.exports}});