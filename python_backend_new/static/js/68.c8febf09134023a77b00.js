webpackJsonp([68],{SuXu:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("a3Yh"),l=a.n(i),n=a("aA9S"),r=a.n(n),o=a("D4TX"),s=a("GOyC"),c=a("R5Jg"),p=a("IkF9"),d=a("pxwZ"),h="/major/major_info/",u=function(e){return Object(d.b)(h,e)},m={data:function(){var e=this;return{dialogTitle:"",del_selected:[],pmcodeAll:[{value:"-1",label:"一级领域专业类型"}],dialogFormVisible:!1,serial:"",rules:{mname:[{required:!0,message:"请输入领域专业类型名称",trigger:"blur"},{min:2,max:60,message:"长度在 2 到 60 个字符",trigger:"blur"}],mtype:[{required:!0,message:"请选择类型",trigger:"blur"}]},currentEditLine:0,select_word:"",formData:{},handleType:"new",formOptions:{labelWidth:"200px"},formItems:[{prop:"mname",text:"领域专业类型名称",label:"领域专业类型名称",$default:null,type:"input",eleProps:{placeholder:"请填写领域专业类名称"},rules:[{required:!0,message:"请填写领域专业类名称",trigger:"change"},{min:1,max:64,message:"长度在1到64个字符",trigger:"blur"}]},{prop:"mtype",text:"类型",label:"类型",$default:null,type:"select",eleProps:{placeholder:"请选择类型"},options:[{value:2,label:"领域"},{value:1,label:"专业"}],rules:[{required:!0,message:"请选择类型",trigger:"change"}]},{prop:"pmcode",text:"父级领域专业",label:"父级领域专业",$default:null,type:"select",eleProps:{placeholder:"请选择父级领域专业"},options:[]},{prop:"mabbr",text:"领域专业类型简称",label:"领域专业类型简称",$default:null,type:"input",eleProps:{placeholder:"请填写领域专业类型简称",type:"textarea"}},{prop:"mlevel",text:"领域专业类型级别",label:"领域专业类型级别",$default:null,type:"select",eleProps:{placeholder:"请选择领域专业类型级别"},options:[{value:1,label:"1"},{value:2,label:"2"}]},{prop:"state",text:"状态",label:"状态",$default:1,type:"switch",eleProps:{"inactive-value":0,"active-value":1,"active-text":"启用","inactive-text":"禁用"}},{prop:"is_hot",text:"是否热门(首页显示)",label:"是否热门(首页显示)",$default:0,type:"select",eleProps:{placeholder:"请选择是否热门(首页显示)"},options:[{value:0,label:"否"},{value:1,label:"是"}]},{type:"upload",prop:"major_cover",label:"领域专业封面",defaultList:[],$default:null,limitNum:1,listType:"pictures",state:"major_cover",icon:a("6pu8"),acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"领域专业封面"}}],handleConfig:{searchTerms:[{value:"mname",label:"领域专业类型名称",placeholder:"请输入领域专业类型名称"}],newItemTxt:"创建领域专业类型",delBtn:!1,auditBtn:!1},total:0,list:[],columns:[{prop:"mname",label:"领域专业类型名称",align:"center",width:180},{prop:"mtype",label:"类型",align:"center",width:180,render:function(e,t){return e("el-tag",{props:{type:1===t.row.mtype?"info":"success"}},1===t.row.mtype?"专业":"领域")}},{prop:"pmname",label:"上级领域专业类型",align:"center",width:120},{prop:"state",label:"状态",align:"center",width:120,render:function(e,t){return e("el-tag",{props:{type:0===t.row.state?"danger":"success"}},0===t.row.state?"禁用":"启用")}},{prop:"is_hot",label:"是否热门",align:"center",width:120,render:function(e,t){return e("el-tag",{props:{type:0===t.row.is_hot?"danger":"success"}},0===t.row.is_hot?"否":"是")}},{prop:"major_cover",label:"领域专业封面",align:"center",width:250,formatter:function(e,t,a){if(e.major_cover)return'<img src="'+e.major_cover+'" style="max-width:200px;max-height:120px;">'}},{prop:"mabbr",label:"领域专业类型描述",align:"center",width:"160"},{prop:"mlevel",label:"领域专业类型级别",align:"center",width:180},{prop:"insert_time",label:"创建日期",align:"center",width:180},{prop:"creater",label:"创建人",align:"center",width:180}],operates:{width:200,fixed:"right",list:[{label:"编辑",type:"warning",show:function(e,t){return!0},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,a){e.handleEdit(t,a)}},{label:"删除",type:"danger",icon:"el-icon-delete",show:!0,plain:!1,disabled:!1,method:function(t,a){e.handleDel(t,a)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!0,index:!0,maxHeight:1200}}},components:{jsonForm:p.a,curmbs:o.a,handleBox:s.a,opTable:c.a},methods:{handleCancle:function(){this.$refs.formData.resetForm(),this.dialogFormVisible=!1},handleClose:function(e){this.$refs.formData.resetForm(),e()},handleOpen:function(){this.$refs.formData.initSelect()},handleCofirm:function(e){var t,a,i,l=this;if(!this.$refs.formData.validateForm())return!1;"edit"==this.handleType?(a=this.serial,i=e,Object(d.c)(h+a+"/",i)).then(function(e){if(e.detail)return l.$message.error(e.detail),!1;l.list.splice(l.currentEditLine,1,e),l.dialogFormVisible=!1,l.$message({type:"success",message:"编辑成功!"}),l.getList()}):(t=e,Object(d.d)(h,t)).then(function(e){e.detail&&l.$message.error(e.detail),l.list.splice(0,0,e),l.dialogFormVisible=!1,l.$message({type:"success",message:"添加成功!"}),l.getList()})},handleEdit:function(e,t){var a=this;this.resetExtrForm(),this.currentEditLine=t,this.dialogTitle="编辑",this.handleType="edit",this.serial=e.serial,this.getPmajorinfo(),this.dialogFormVisible=!0,this.formData=r()({},e),this.formItems.forEach(function(t,i){t.state&&e[t.prop]&&("text"==t.listType?a.forMataAttachList(t.state,a.formData[t.prop],i):a.forMataFileList(t.state,a.formData.major_cover,i)),void 0!==t.defaultValue&&a.$nextTick(function(){a.$set(t,"defaultValue",e[t.prop])})})},forMataAttachList:function(e,t,a){var i=this;if(this.formItems[a].defaultList=[],t.length)for(var n=function(n){var r={};r.response="attachment"==e?l()({},e,[t[n].down]):l()({},e,t[n].down),r.response=l()({},e,t[n].down),r.status="success",r.file_caption=t[n].file_caption,r.percentage="100",i.$nextTick(function(){i.formItems[a].defaultList.push(r)})},r=0;r<t.length;r++)n(r)},forMataFileList:function(e,t,a){var i=this,n={};n.response=l()({},e,t),n.status="success",n.percentage="100",this.$nextTick(function(){i.formItems[a].defaultList.splice(0,1,n)})},resetExtrForm:function(){var e=this;this.formItems.forEach(function(t,a){e.$set(e.formData,t.prop,t.$default),t.state&&(t.defaultList=[]),void 0!==t.defaultValue&&e.$nextTick(function(){t.defaultValue=null})})},newItem:function(){this.resetExtrForm(),this.getPmajorinfo(),this.dialogTitle="创建领域类型",this.currentEditLine=0,this.handleType="new",this.dialogFormVisible=!0},search:function(e,t){this.select_word=t,this.pagination.pageIndex=1,this.getList()},getPmajorinfo:function(){var e=this;u({params:{pageSize:"max",pmcode:"-1"}}).then(function(t){for(var a in t.detail&&e.$message.error(t.detail),e.pmcodeAll.length=1,t.results)e.pmcodeAll.push({value:t.results[a].mcode,label:t.results[a].mname});for(var a in e.formItems)"pmcode"==e.formItems[a].prop&&e.$set(e.formItems[a],"options",e.pmcodeAll)})},getList:function(){var e=this;this.options.loading=!0,u({params:{page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word}}).then(function(t){t.detail&&e.$message.error(t.detail),e.total=t.count,e.pagination.total=Number(t.count),e.list=t.results,e.options.loading=!1})},handleSizeChange:function(e){this.pagination=e,this.getList()},handleIndexChange:function(e){this.pagination=e,this.getList()},handleSelectionChange:function(e){var t=new Array;for(var a in select_arr)t.push(select_arr[a].serial);this.del_selected=t},handleDel:function(e,t){var a=this;this.$confirm("此操作将删除该领域类型, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i;(i=e.serial,Object(d.a)(h+i+"/")).then(function(e){if(e.detail)return a.$message.error(e.detail),!1;a.list.splice(t,1)}).then(function(){a.$message({type:"success",message:"删除成功!"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},delAll:function(){}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"warp-box"},[a("curmbs"),e._v(" "),a("div",{staticClass:"container"},[a("handleBox",{attrs:{handleConfig:e.handleConfig},on:{delAll:e.delAll,search:e.search,newItem:e.newItem}}),e._v(" "),a("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),a("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"before-close":e.handleClose,modal:!1,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t},opened:e.handleOpen}},[a("jsonForm",{ref:"formData",attrs:{handleType:e.handleType,formData:e.formData,formItems:e.formItems,formOptions:e.formOptions},on:{handleCancle:e.handleCancle,handleCofirm:e.handleCofirm}})],1)],1)],1)},staticRenderFns:[]};var g=a("C7Lr")(m,f,!1,function(e){a("a6Hd")},"data-v-ae6a3e50",null);t.default=g.exports},a6Hd:function(e,t){}});