webpackJsonp([84],{"8DMO":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("D4TX"),a=n("GOyC"),i=n("R5Jg"),s=n("93JQ"),r=n("vnAp"),l=n("YaB9"),c={data:function(){var e=this;return{searchplaceholder:"请输入项目名称",step_code:1,substep_code:1,project_from_str:l.q,project_cstate_str:l.p,dialogTitle:"",dialogFormVisible:!1,serial:"",rules:{cmsg:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},currentEditLine:0,select_word:"",formData:{},handleType:"new",formBtnList:[{label:"取消",type:"info",show:!1,icon:"",plain:!0,disabled:!1,method:"handleCancle"},{label:"提交",type:"success",icon:"",show:!0,plain:!1,disabled:!1,method:"handleIdent"}],formOptions:{},formItems:[{prop:"cstate",text:"审核结果",label:"审核结果",type:"switch",eleProps:{"inactive-value":-1,"active-value":1,"active-text":"通过","inactive-text":"不通过"}},{prop:"cmsg",text:"审核意见",label:"审核意见",type:"input",eleProps:{type:"textarea",rows:4,placeholder:"请输入审核意见"}}],handleConfig:{searchTerms:[{value:"project_name",label:"项目名称"}],newItemTxt:!1,delBtn:!1},total:0,list:[],columns:[{prop:"project_name",label:"项目名称",align:"center",width:280,formatter:function(e,t,n){return e.project_info.project_name}},{prop:"project_state",label:"项目阶段",align:"center",width:"80",render:function(e,t){return e("span",{},Object(l.h)(t.row.project_info.project_state))}},{prop:"project_sub_state",label:"项目子阶段",align:"center",width:"120",render:function(e,t){return e("span",{},Object(l.j)(t.row.project_info.project_state,t.row.project_info.project_sub_state))}},{prop:"substep_serial_type",label:"子步骤操作类型",align:"center",width:"120",render:function(e,t){return e("span",{},Object(l.k)(t.row.project_info.project_state,t.row.project_info.project_sub_state,t.row.substep_serial_info.substep_serial_type))}},{prop:"cstate",label:"审核状态",align:"center",width:100,render:function(t,n){return t("el-tag",{props:{type:-1===n.row.cstate?"danger":1===n.row.cstate?"success":"info"}},void 0===e.project_cstate_str[n.row.cstate]?"不详":e.project_cstate_str[n.row.cstate])}},{prop:"submit_time",label:"申请提交时间",align:"center",width:180,render:function(e,t){return e("span",{},t.row.substep_serial_info.submit_time)}},{prop:"broker_info",label:"技术经理人",align:"center",width:160,formatter:function(e,t,n){return e.project_info.broker_info.broker.broker_name}},{prop:"expert_info",label:"专家",align:"center",width:160,formatter:function(e,t,n){for(var o=e.project_info.expert_info,a="",i=0;i<o.length;i++)o[i].expert&&(a+=o[i].expert.expert_name+" ");return a}},{prop:"majors",label:"领域",align:"center",width:160,formatter:function(e,t,n){for(var o=e.project_info.majors,a="",i=0;i<o.length;i++)a+=o[i].mname+" ";return a}},{prop:"insert_time",label:"项目创建时间",align:"center",width:160,formatter:function(e,t,n){return e.project_info.insert_time}}],operates:{width:100,fixed:"right",list:[{label:"详情",type:"primary",show:function(t,n){return 0==n.cstate?e.operates.width=200:e.operates.width=100,!0},icon:"el-icon-info",plain:!0,disabled:!1,method:function(t,n){e.handleDetail(t,n)}},{label:"审核",type:"warning",show:function(e,t){return 0==t.cstate},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,n){e.handleCheck(t,n)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{index:!0,stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!1}}},components:{jsonForm:s.a,curmbs:o.a,handleBox:a.a,opTable:i.a},mounted:function(){},methods:{handleClose:function(e){this.$refs.formDialog.$children[0].$refs.formData.clearValidate(),e()},handleCofirm:function(e){},newItem:function(){},search:function(e,t){console.log("search:"+e+","+t),this.select_word=t,this.getList()},delAll:function(){},getList:function(){var e=this;this.options.loading=!0,Object(r.b)({params:{step_code:this.step_code,substep_code:this.substep_code,page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word}}).then(function(t){console.info(t),e.total=t.data.count,e.pagination.total=Number(t.data.count),e.list=t.data.results,e.options.loading=!1})},handleSizeChange:function(e){this.pagination=e,console.log("handleSizeChange:"+this.pagination.pageSize),this.getList()},handleIndexChange:function(e){this.pagination=e,console.log("handleIndexChange:"+this.pagination.pageIndex),this.getList()},handleSelectionChange:function(e){},handleEdit:function(e,t){},handleDel:function(e,t){},handleDetail:function(e,t){this.$router.push({name:"project_detail",query:{serial:e.project_info.pserial}})},handleCheck:function(e,t){this.dialogTitle="审核",this.handleType="edit",console.info(e),this.serial=e.project_info.pserial,this.$set(this.formData,"project_code",e.project_code),this.$set(this.formData,"step_code",e.step_code),this.$set(this.formData,"substep_code",e.substep_code),this.$set(this.formData,"substep_serial",e.substep_serial),this.$set(this.formData,"substep_serial_type",e.substep_serial_info.substep_serial_type),this.$set(this.formData,"cstate",-1),this.$set(this.formData,"cmsg",""),console.info(this.formData),this.dialogFormVisible=!0},handleIdent:function(){var e=this;console.info(this.formData),this.formData.cmsg?Object(r.a)(this.serial,this.formData).then(function(t){t.detail?e.$message.error(t.detail):1==t.state?(e.$message({type:"success",message:"审核成功!"}),e.dialogFormVisible=!1,e.getList()):e.$message({type:"error",message:t.msg})}):this.$message({type:"error",message:"审核意见不能为空"})}}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"warp-box"},[n("curmbs"),e._v(" "),n("div",{staticClass:"container"},[n("handleBox",{attrs:{handleConfig:e.handleConfig,searchplaceholder:e.searchplaceholder},on:{delAll:e.delAll,search:e.search,newItem:e.newItem}}),e._v(" "),n("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),n("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"before-close":e.handleClose,modal:!1,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("jsonForm",{attrs:{formBtnList:e.formBtnList,handleType:e.handleType,formData:e.formData,rules:e.rules,formItems:e.formItems,formOptions:e.formOptions},on:{handleCancle:function(t){e.dialogFormVisible=!1},handleIdent:e.handleIdent}})],1)],1)],1)},staticRenderFns:[]};var d=n("C7Lr")(c,p,!1,function(e){n("A/XS")},"data-v-227d7358",null);t.default=d.exports},"A/XS":function(e,t){}});