webpackJsonp([74],{"5rBP":function(e,t){},wiTZ:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("a3Yh"),i=l.n(a),r=l("aA9S"),n=l.n(r),s=l("D4TX"),o=l("GOyC"),p=l("R5Jg"),u=l("IkF9"),d=(l("8V1Y"),l("k5wd"));var c,g,h,m=(c=new Date,g=c.getMonth()+1<10?"0"+(c.getMonth()+1):c.getMonth()+1,h=c.getDate()<10?"0"+c.getDate():c.getDate(),c.getFullYear()+"-"+g+"-"+h+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()),f={data:function(){var e=this;return{group_arr:[],del_selected:[],state_arr:{0:"伪删除",1:"已创建",2:"已上线",3:"报名中",4:"待开始",5:"进行中",6:"已结束",7:"已下架"},activiyt_type_arr:{1:"线上",2:"线下",3:"线上线下"},activity_sort_arr:{1:"成果推介活动",2:"需求推介活动",3:"转化活动",4:"融资交流活动",5:"供需交流活动",6:"项目合作活动",7:"服务推荐活动",8:"专利申请培训活动",9:"对接会",10:"直播类",11:"其他"},dialogTitle:"",dialogFormVisible:!1,serial:"",currentEditLine:0,select_word:"",formData:{},handleType:"new",formOptions:{labelWidth:"250px"},formItems:[{prop:"activity_title",text:"活动标题",label:"活动标题",$default:null,type:"input",eleProps:{placeholder:"活动标题",maxlength:64},rules:[{required:!0,message:"请输入活动标题",trigger:"change"},{min:1,max:64,message:"长度在1到64个字符",trigger:"blur"}]},{prop:"activity_type",text:"活动形式",label:"活动形式",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择活动形式"},options:[{value:1,label:"线上"},{value:2,label:"线下"},{value:3,label:"线上线下"}],rules:[{required:!0,message:"请选择活动形式",trigger:"change"}]},{prop:"activity_abstract",text:"活动摘要",label:"活动摘要",$default:null,type:"input",eleProps:{placeholder:"活动摘要",maxlength:255},rules:[{required:!0,message:"请输入活动摘要",trigger:"change"},{min:1,max:255,message:"长度在1到255个字符",trigger:"blur"}]},{prop:"has_lottery",text:"是否有抽奖",label:"是否有抽奖",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择是否有抽奖"},options:[{value:1,label:"是"},{value:2,label:"否"}]},{prop:"lottery_desc",text:"抽奖描述",label:"抽奖描述",$default:null,type:"editor",defaultValue:"",apiUrl:"",imageShow:!1,eleProps:{maxlength:65535,type:"textarea"}},{prop:"activity_sort",text:"活动内容分类",label:"活动内容分类",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择活动内容分类"},options:[{value:1,label:"成果推介活动"},{value:2,label:"需求推介活动"},{value:3,label:"转化活动"},{value:4,label:"融资交流活动"},{value:6,label:"项目合作活动"},{value:7,label:"服务推荐活动"},{value:8,label:"专利申请培训活动"},{value:9,label:"对接会"},{value:10,label:"直播类"},{value:11,label:"其他"}],rules:[{required:!0,message:"请选择活动内容分类",trigger:"change"}]},{prop:"activity_site",text:"线上活动url",label:"线上活动url",$default:null,type:"input",eleProps:{placeholder:"线上活动url",maxlength:255},rules:[{min:1,max:255,message:"线上活动url长度在1到255个字符",trigger:"blur"}]},{prop:"district_id",text:"活动地区",label:"活动地区",type:"selectregion",eleProps:{placeholder:"请选择活动地区"}},{prop:"address",text:"活动详细地址",label:"活动详细地址",$default:null,type:"input",eleProps:{placeholder:"活动详细地址",maxlength:255},rules:[{min:1,max:255,message:"活动详细地址长度在1到255个字符",trigger:"blur"}]},{prop:"longitude",text:"经度",label:"经度",$default:"0.00000",type:"input",eleProps:{placeholder:"经度",maxlength:10},rules:[{min:1,max:10,message:"经度长度在1到10个字符",trigger:"blur"}]},{prop:"latitude",text:"纬度",label:"纬度",$default:"0.00000",type:"input",eleProps:{placeholder:"纬度",maxlength:10},rules:[{min:1,max:10,message:"纬度长度在1到10个字符",trigger:"blur"}]},{prop:"online_time",text:"上线时间",label:"上线时间",$default:null,type:"onlytime",eleProps:{placeholder:"上线时间"},rules:[{required:!0,message:"请选择上线时间",trigger:"change"}]},{prop:"down_time",text:"下架时间",label:"下架时间",$default:null,type:"onlytime",eleProps:{placeholder:"下架时间"},rules:[{required:!0,message:"请选择下架时间",trigger:"change"}]},{prop:"signup_start_time",text:"报名开始时间",label:"报名开始时间",$default:null,type:"onlytime",eleProps:{placeholder:"报名开始时间"},rules:[{required:!0,message:"请选择报名开始时间",trigger:"change"}]},{prop:"signup_end_time",text:"报名截止时间",label:"报名截止时间",$default:null,type:"onlytime",eleProps:{placeholder:"报名截止时间"},rules:[{required:!0,message:"请选择报名截止时间",trigger:"change"}]},{prop:"activity_start_time",text:"活动开始时间",label:"活动开始时间",$default:null,type:"onlytime",eleProps:{placeholder:"活动开始时间"},rules:[{required:!0,message:"请选择活动开始时间",trigger:"change"}]},{prop:"activity_end_time",text:"活动结束时间",label:"活动结束时间",$default:null,type:"onlytime",eleProps:{placeholder:"活动结束时间"},rules:[{required:!0,message:"请选择活动结束时间",trigger:"change"}]},{prop:"top",text:"是否置顶",label:"是否置顶",$default:2,type:"select",eleProps:{filterable:!0,placeholder:"请选择是否置顶"},options:[{value:1,label:"置顶"},{value:2,label:"不置顶"}]},{prop:"top_time",text:"置顶时间",label:"置顶时间",$default:null,type:"onlytime",eleProps:{placeholder:"置顶时间"}},{prop:"summary_time",text:"总结时间",label:"总结时间",$default:null,type:"onlytime",eleProps:{placeholder:"总结时间"}},{prop:"max_people_number",text:"活动最大参与人数",label:"活动最大参与人数",$default:null,type:"input",eleProps:{placeholder:"活动最大参与人数",maxlength:10},rules:[{required:!0,message:"请输入活动最大参与人数",trigger:"change"}]},{prop:"signup_check",text:"报名是否需要审核",label:"报名是否需要审核",$default:2,type:"select",eleProps:{filterable:!0,placeholder:"请选择报名是否需要审核"},options:[{value:1,label:"是"},{value:2,label:"否"}]},{prop:"signup_people_number",text:"报名人数",label:"报名人数",$default:null,type:"input",eleProps:{placeholder:"报名人数",maxlength:10}},{prop:"state",text:"状态",label:"状态",$default:null,type:"select",eleProps:{filterable:!0,placeholder:"请选择状态"},options:[{value:0,label:"伪删除"},{value:1,label:"已创建"},{value:2,label:"已上线"},{value:3,label:"报名中"},{value:4,label:"待开始"},{value:5,label:"进行中"},{value:6,label:"已结束"},{value:7,label:"已下架"}],rules:[{required:!0,message:"请选择状态",trigger:"change"}]},{prop:"contacter",text:"活动联系人",label:"活动联系人",$default:null,type:"input",eleProps:{placeholder:"活动联系人",maxlength:32},rules:[{required:!0,message:"请输入活动联系人",trigger:"change"},{min:1,max:32,message:"长度在1到32个字符",trigger:"blur"}]},{prop:"mobile",text:"活动联系人手机号",label:"活动联系人手机号",$default:null,type:"input",eleProps:{placeholder:"请输入手机号码",maxlength:11},rules:[{required:!0,message:"请输入手机号码",trigger:"change"},{min:11,max:11,message:"手机号码要求11位",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},{type:"upload",prop:"activity_cover",label:"活动宣传图(最多5张图片)",defaultList:[],$default:null,limitNum:5,listType:"pictures",state:"activity_cover",upLoadBtnTxt:"上传图片",icon:l("6pu8"),acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF",eleProps:{placeholder:"活动宣传图(最多5张)"},rules:[{required:!0,message:"活动宣传图(最多5张)",trigger:"change"}]},{prop:"activity_content",text:"活动详情",label:"活动详情",$default:null,type:"editor",videoShow:!0,defaultValue:"",apiUrl:"",eleProps:{maxlength:65535},rules:[{required:!0,message:"请填写活动详情",trigger:"change"}]},{type:"upload",prop:"attach",label:"附件(图片文本[10M]音频[50M]最多10个)",defaultList:[],$default:null,state:"attachment",limitNum:10,listType:"text",icon:l("pFwa"),acceptType:".jpg,.jpeg,.png,.gif,.pdf,.JPG,.JPEG,.PNG,.GIF,.doc,.docx,.xls,.xlsx,.pdf,.DOC,.DOCX,.XLS,.XLSX,.PDF,.zip,.ZIP,.mp3,.MP3",eleProps:{placeholder:"附件(图片文本(10M)音频(50M))"},method:"successUpload"}],handleConfig:{searchTerms:[{value:"activity_title",label:"活动标题"}],newItemTxt:"创建活动",auditBtn:!1},total:0,list:[],columns:[{prop:"activity_title",label:"活动标题",align:"center",width:180},{prop:"activity_type",label:"活动形式",align:"center",width:180,formatter:function(t,l,a){return e.activiyt_type_arr[t.activity_type]}},{prop:"activity_sort",label:"活动内容分类",align:"center",width:180,formatter:function(t,l,a){return e.activity_sort_arr[t.activity_sort]}},{prop:"state",label:"状态",align:"center",width:"160",render:function(t,l){return t("el-tag",{props:{type:0===l.row.state?"danger":1===l.row.state?"success":"info"}},e.state_arr[l.row.state])}},{prop:"online_time",label:"上线时间",align:"center",width:180},{prop:"signup_start_time",label:"报名开始时间",align:"center",width:180},{prop:"signup_end_time",label:"报名截止时间",align:"center",width:180},{prop:"activity_start_time",label:"活动开始时间",align:"center",width:180},{prop:"activity_end_time",label:"活动结束时间",align:"center",width:180},{prop:"max_people_number",label:"活动最大参与人数",align:"center",width:180},{prop:"signup_people_number",label:"报名人数",align:"center",width:180},{prop:"down_time",label:"下架时间",align:"center",width:180}],operates:{width:400,fixed:"right",list:[{label:"详情",type:"primary",show:function(e,t){return!0},icon:"el-icon-info",plain:!0,disabled:!1,method:function(t,l){e.handleDetail(t,l)}},{label:"抽奖管理",type:"primary",show:function(e,t){return 1==t.has_lottery},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,l){e.handleLottery(t,l)}},{label:"总结",type:"primary",show:function(e,t){new Date;return t.activity_end_time<m},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,l){e.handleSummary(t,l)}},{label:"编辑",type:"warning",show:function(e,t){return!0},icon:"el-icon-edit",plain:!0,disabled:!1,method:function(t,l){e.handleEdit(t,l)}},{label:"删除",type:"danger",icon:"el-icon-delete",show:!0,plain:!1,disabled:!1,method:function(t,l){e.handleDel(t,l)}}]},pagination:{pageIndex:1,pageSize:10,show:!0,total:0},options:{stripe:!0,loading:!1,highlightCurrentRow:!0,mutiSelect:!0,index:!0}}},components:{jsonForm:u.a,curmbs:s.a,handleBox:o.a,opTable:p.a},methods:{handleCancle:function(){this.$refs.formData.resetForm(),this.dialogFormVisible=!1},handleClose:function(e){this.$refs.formData.resetForm(),e()},handleOpen:function(){this.$refs.formData.initSelect()},handleCofirm:function(e){var t=this;if(!this.$refs.formData.validateForm())return!1;"edit"==this.handleType?Object(d.v)(this.serial,e).then(function(e){if(e.detail)return t.$message.error(e.detail),!1;t.list.splice(t.currentEditLine,1,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"编辑成功!"}),t.getList()}):Object(d.a)(e).then(function(e){if(e.detail)return t.$message.error(e.detail),!1;t.list.splice(0,0,e),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加成功!"}),t.getList()})},handleEdit:function(e,t){var l=this;this.resetExtrForm(),this.currentEditLine=t,this.dialogTitle="编辑活动",this.handleType="edit",this.serial=e.serial,this.dialogFormVisible=!0,this.formData=n()({},e),this.formItems.forEach(function(t,a){t.state&&e[t.prop]&&("picture"!==t.listType?l.forMataAttachList(t.state,l.formData[t.prop],a):l.forMataFileList(t.state,l.formData.face_pic,a)),void 0!==t.defaultValue&&l.$nextTick(function(){l.$set(t,"defaultValue",e[t.prop])})})},forMataAttachList:function(e,t,l){var a=this;if(this.formItems[l].defaultList=[],t.length)for(var r=function(r){var n={};n.response="attachment"==e?i()({},e,[t[r].down]):i()({},e,t[r].down),n.status="success",n.file_caption=t[r].file_caption,n.percentage="100",a.$nextTick(function(){a.formItems[l].defaultList.push(n)})},n=0;n<t.length;n++)r(n)},forMataFileList:function(e,t,l){var a=this,r={};r.response=i()({},e,t),r.status="success",r.percentage="100",this.$nextTick(function(){a.formItems[l].defaultList.splice(0,1,r)})},resetExtrForm:function(){var e=this;this.formItems.forEach(function(t,l){e.$set(e.formData,t.prop,t.$default),t.state&&(t.defaultList=[]),void 0!==t.defaultValue&&e.$nextTick(function(){t.defaultValue=null})})},newItem:function(){this.resetExtrForm(),this.dialogTitle="新增活动",this.currentEditLine=0,this.handleType="new",this.dialogFormVisible=!0},search:function(e,t){this.select_word=t,this.pagination.pageIndex=1,this.getList()},getList:function(){var e=this;this.options.loading=!0,Object(d.C)({params:{page:this.pagination.pageIndex,page_size:this.pagination.pageSize,search:this.select_word}}).then(function(t){e.total=t.data.count,e.pagination.total=Number(t.data.count),e.list=t.data.results,e.options.loading=!1})},handleSizeChange:function(e){this.pagination=e,this.getList()},handleIndexChange:function(e){this.pagination=e,this.getList()},handleSelectionChange:function(e){var t=new Array;for(var l in e)t.push(e[l].serial);this.del_selected=t},handleDetail:function(e,t){this.$router.push({name:"activity_detail",query:{serial:e.serial}})},handleSummary:function(e,t){this.$router.push({name:"activity_summary",query:{serial:e.serial}})},handleLottery:function(e,t){this.$router.push({name:"activity_lottery",query:{activity_code:e.activity_code}})},handleDel:function(e,t){var l=this;this.$confirm("此操作将删除该活动是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.h)(e.serial).then(function(e){if(e.detail)return l.$message.error(e.detail),!1;l.list.splice(t,1)}).then(function(){l.$message({type:"success",message:"删除成功!"})})}).catch(function(){l.$message({type:"info",message:"已取消删除"})})},delAll:function(){var e=this;if(0==this.del_selected.length)return this.$message({type:"error",message:"请选择要批量删除的活动!"}),!1;var t=this.del_selected.shift();Object(d.i)(t,{data:this.del_selected}).then(function(t){if(t.detail)return e.$message.error(t.detail),!1;e.dialogFormVisible=!1,e.$message({type:"success",message:"批量删除成功!",duration:500,onClose:function(){window.location.reload()}})})}}},b={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"warp-box"},[l("curmbs"),e._v(" "),l("div",{staticClass:"container"},[l("handleBox",{attrs:{handleConfig:e.handleConfig},on:{delAll:e.delAll,search:e.search,newItem:e.newItem}}),e._v(" "),l("opTable",{attrs:{list:e.list,total:e.total,options:e.options,pagination:e.pagination,columns:e.columns,operates:e.operates,getList:e.getList},on:{handleSizeChange:e.handleSizeChange,handleIndexChange:e.handleIndexChange,handleSelectionChange:e.handleSelectionChange}}),e._v(" "),l("el-dialog",{ref:"formDialog",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"before-close":e.handleClose,modal:!1,"lock-scroll":!0},on:{"update:visible":function(t){e.dialogFormVisible=t},opened:e.handleOpen}},[l("jsonForm",{ref:"formData",attrs:{handleType:e.handleType,formData:e.formData,formItems:e.formItems,formOptions:e.formOptions},on:{handleCancle:e.handleCancle,handleCofirm:e.handleCofirm}})],1)],1)],1)},staticRenderFns:[]};var y=l("C7Lr")(f,b,!1,function(e){l("5rBP")},"data-v-6c5cc5c9",null);t.default=y.exports}});